import{r as V,s as O,e as y,c as Q,a as q,w as a,d as l,g as r,f as n,j as H,H as J,v as L,b as S,F as W,h as j,u as o,t as b,m as I,_ as Y,i as Z,z as ee,q as h,L as F,X as w,U as x,W as z,$ as le,M as te,N as E,O as R,Q as ae,x as oe,K as B,R as se}from"./index-TO8iFplr.js";import{u as K}from"./useDates-sS5pNIz9.js";const ne={class:"modal-body",style:{"max-height":"400px","overflow-y":"auto"}},de={class:"d-flex gap-2 mb-3"},ue={class:"d-flex gap-2 mb-3"},re={class:"table table-bordered table-hover"},ie={class:"table table-bordered table-hover mb-0"},_e=["onDblclick"],pe={__name:"waitingSemiPrdtModal",props:{visible:Boolean},emits:["close","select"],setup(G,{emit:P}){const C=P,g=()=>{c.value=[],C("close")},m=V({pickValue:"prdt_nm",wk_to_dt:"",searchKeyword:""});let c=O([]);const k=async()=>{c.value=[];const t={prdt_nm:"",pass_qy:"",wk_to_dt:m.value.wk_to_dt||"1970-01-01"};m.value.pickValue=="prdt_nm"?t.prdt_nm=m.value.searchKeyword:t.pass_qy=m.value.searchKeyword;let d=await I.get("/api/waitingSemiPrdt",{params:t}).catch(u=>console.log(u));c.value=d.data,m.value.wk_to_dt="",m.value.searchKeyword=""},N=async t=>{const d={prdt_id:"",prdt_opt_id:""};d.prdt_id=t.prdt_id,d.prdt_opt_id=t.prdt_opt_id;let u=await I.get("/api/waitingPrdtQltyDeta",{params:d}).catch(f=>console.log(f));console.log(u.data),C("select",{detailData:u.data,searchParams:t}),g()};return(t,d)=>{const u=y("CModalTitle"),f=y("CModalHeader"),M=y("CInputGroupText"),$=y("CModalBody"),T=y("CButton"),D=y("CModalFooter"),U=y("CModal");return q(),Q(U,{visible:G.visible,onClose:g},{default:a(()=>[l(f,null,{default:a(()=>[l(u,null,{default:a(()=>[...d[4]||(d[4]=[r("반제품생산실적조회",-1)])]),_:1})]),_:1}),l($,null,{default:a(()=>[n("div",ne,[n("div",de,[H(n("select",{class:"form-select",style:{width:"150px"},"onUpdate:modelValue":d[0]||(d[0]=s=>m.value.pickValue=s)},[...d[5]||(d[5]=[n("option",{value:"prdt_nm"},"반제품명",-1),n("option",{value:"pass_qy"},"검사대기수량",-1)])],512),[[J,m.value.pickValue]]),H(n("input",{type:"text",class:"form-control",placeholder:"검색어 입력","onUpdate:modelValue":d[1]||(d[1]=s=>m.value.searchKeyword=s)},null,512),[[L,m.value.searchKeyword]])]),n("div",ue,[l(M,{id:"addon-ordr-name-2"},{default:a(()=>[...d[6]||(d[6]=[r("작업종료날짜",-1)])]),_:1}),H(n("input",{type:"date",class:"form-control","onUpdate:modelValue":d[2]||(d[2]=s=>m.value.wk_to_dt=s)},null,512),[[L,m.value.wk_to_dt]]),n("button",{class:"btn btn-secondary",style:{width:"100px"},onClick:d[3]||(d[3]=s=>k())},"검색")]),n("table",re,[d[7]||(d[7]=n("thead",{class:"table-light"},[n("tr",null,[n("th",null,"반제품명"),n("th",null,"검사대기수량"),n("th",null,"작업종료날짜")])],-1)),n("tbody",ie,[(q(!0),S(W,null,j(o(c),(s,e)=>(q(),S("tr",{key:e,onDblclick:p=>N(s)},[n("td",null,b(s.prdt_nm),1),n("td",null,b(Number(s.bePass_qy)),1),n("td",null,b(o(K).dateFormat(s.wk_to_dt,"yyyy-MM-dd")),1)],40,_e))),128))])])])]),_:1}),l(D,null,{default:a(()=>[l(T,{color:"secondary",onClick:g},{default:a(()=>[...d[8]||(d[8]=[r("닫기",-1)])]),_:1})]),_:1})]),_:1},8,["visible"])}}},me={class:"modal-body",style:{"max-height":"400px","overflow-y":"auto"}},ye={class:"mb-3"},ve={class:"d-flex gap-2 mb-3"},ce={class:"d-flex gap-2 mb-3"},fe={class:"table table-bordered table-hover"},be={class:"table table-bordered table-hover mb-0"},qe=["onDblclick"],Ce={__name:"semiPrdtQltyInspModal",props:{visible:Boolean},emits:["close","select"],setup(G,{emit:P}){const C=P,g=()=>{m.value="",c.value="",k.value=[],C("close")},m=V(""),c=V("");let k=O([]);const N=async()=>{const d={emp_nm:m.value||"",insp_dt:c.value||"1970-01-01"};console.log(d);let u=await I.get("/api/semiPrdtQltyInspSearch",{params:d}).catch(f=>console.log(f));console.log(u.data),k.value=u.data},t=async d=>{const u={semi_prdt_qlty_insp_id:""};u.semi_prdt_qlty_insp_id=d.semi_prdt_qlty_insp_id;let f=await I.get("/api/semiPrdtQltyInspInferSearch",{params:u}).catch(M=>console.log(M));console.log(f.data),C("select",{detailData:f.data,searchParams:d}),g()};return(d,u)=>{const f=y("CModalTitle"),M=y("CModalHeader"),$=y("CInputGroupText"),T=y("CFormInput"),D=y("CInputGroup"),U=y("CModalBody"),s=y("CButton"),e=y("CModalFooter"),p=y("CModal");return q(),Q(p,{visible:G.visible,onClose:g,size:"xl"},{default:a(()=>[l(M,null,{default:a(()=>[l(f,null,{default:a(()=>[...u[3]||(u[3]=[r("반제품 품질조회",-1)])]),_:1})]),_:1}),l(U,null,{default:a(()=>[n("div",me,[n("div",ye,[n("div",ve,[l(D,{class:"mb-2"},{default:a(()=>[l($,{id:"addon-ordr-name-1"},{default:a(()=>[...u[4]||(u[4]=[r("검사자",-1)])]),_:1}),l(T,{modelValue:m.value,"onUpdate:modelValue":u[0]||(u[0]=i=>m.value=i),placeholder:"검수자이름"},null,8,["modelValue"])]),_:1})]),n("div",ce,[l($,{id:"addon-ordr-name-2"},{default:a(()=>[...u[5]||(u[5]=[r("검사 일자",-1)])]),_:1}),H(n("input",{type:"date",class:"form-control","onUpdate:modelValue":u[1]||(u[1]=i=>c.value=i)},null,512),[[L,c.value]]),n("button",{class:"btn btn-secondary",style:{width:"70px"},onClick:u[2]||(u[2]=i=>N())}," 검색 ")])]),n("table",fe,[u[6]||(u[6]=n("thead",{class:"table-light"},[n("tr",null,[n("th",null,"검사자"),n("th",null,"검사 수량"),n("th",null,"합격 수량"),n("th",null,"불량 수량"),n("th",null,"검사 일자")])],-1)),n("tbody",be,[(q(!0),S(W,null,j(o(k),(i,v)=>(q(),S("tr",{key:v,onDblclick:_=>t(i)},[n("td",null,b(i.emp_nm),1),n("td",null,b(Math.floor(i.insp_qy)),1),n("td",null,b(Math.floor(i.pass_qy)),1),n("td",null,b(Math.floor(i.infer_qy)),1),n("td",null,b(o(K).dateFormat(i.reg_dt,"yyyy-MM-dd")),1)],40,qe))),128))])])])]),_:1}),l(e,null,{default:a(()=>[l(s,{color:"secondary",onClick:g},{default:a(()=>[...u[7]||(u[7]=[r("닫기",-1)])]),_:1})]),_:1})]),_:1},8,["visible"])}}},ge={class:"d-flex justify-content-end gap-2 mb-3"},xe={class:"d-flex justify-content-end gap-2 mb-3"},Me={__name:"semiPrdtQltyInsp",setup(G){const P=Z(),C=V(!1),g=()=>{C.value=!0},m=()=>{C.value=!1},c=V(!1),k=()=>{c.value=!0},N=()=>{c.value=!1},t=V({emp_id:P.user?.emp_id||"EMP001",emp_nm:P.user?.emp_nm||"홍길동",prdt_nm:"",opt_nm:"",qy:"",insp_qy:"",insp_dt:K.dateFormat(new Date,"yyyy-MM-dd"),rm:"",prcs_ctrl_id:"",end_prdt_qlty_insp_id:""}),d=V([]),u=V(0),f=ee(()=>{const s=Number(t.value.insp_qy)||0,e=Number(u.value)||0;return s-e});h(d,s=>{let e=0;for(const p of s){const i=Number(p.infer_qy);isNaN(i)||(e+=i)}u.value=e},{deep:!0}),h(()=>t.value.pass_qy,s=>{const e=Number(t.value.insp_qy)||0,p=Number(s);if(isNaN(p)||p<0){alert("합격 수량은 0 이상의 숫자만 입력 가능합니다."),t.value.pass_qy=0;return}p>e&&(alert("합격 수량이 검수량보다 많을 수 없습니다."),t.value.pass_qy=0)}),h(()=>t.value.insp_qy,s=>{const e=Number(t.value.qy)||0,p=Number(s);if(isNaN(p)||p<0){alert("검수 수량은 0 이상의 숫자만 입력 가능합니다."),t.value.pass_qy=0;return}p>e&&(alert("검수 수량이 실적 수량보다 많을 수 없습니다."),t.value.insp_qy=0)});const M=s=>{console.log(s),d.value=[],t.value.prdt_nm=s.searchParams.prdt_nm,t.value.opt_nm=s.searchParams.opt_nm,t.value.qy=Math.floor(s.searchParams.bePass_qy),t.value.insp_qy=Math.floor(s.searchParams.insp_qy)||0,t.value.pass_qy=Math.floor(s.searchParams.pass_qy)||0,t.value.rm=s.searchParams.rm||"",t.value.prcs_ctrl_id=s.searchParams.prcs_ctrl_id,t.value.semi_prdt_qlty_insp_id=s.searchParams.semi_prdt_qlty_insp_id,t.value.emp_id=s.searchParams.emp_id??P.user?.emp_id??"EMP001",u.value=s.searchParams.infer_qy||0;for(const e of s.detailData)d.value.push({insp_item_nm:e.insp_item_nm,basi_val:e.basi_val,eror_scope_min:e.eror_scope_min,eror_scope_max:e.eror_scope_max,infer_qy:e.infer_qy||0,qlty_item_mng_id:e.qlty_item_mng_id,semi_prdt_qlty_insp_id:e.semi_prdt_qlty_insp_id})},$=async()=>{let s=[];for(const v of d.value)s.push({infer_qy:v.infer_qy,qlty_item_mng_id:v.qlty_item_mng_id});const e={master:{rm:t.value.rm,prcs_ctrl_id:t.value.prcs_ctrl_id,emp_id:t.value.emp_id,infer_qy:u.value,pass_qy:f.value,insp_qy:t.value.insp_qy,insp_dt:t.value.insp_dt},infer:s};console.log(e),(await I.post("/api/semiPrdtQltyInspInsert",e).catch(v=>console.log(v))).data.isSuccessed?console.log("반제품 검수가 등록되었습니다."):console.log("반제품 검수에 실패했습니다.")},T=async()=>{let s=[];for(const v of d.value)s.push({infer_qy:v.infer_qy,qlty_item_mng_id:v.qlty_item_mng_id,semi_prdt_qlty_insp_id:v.semi_prdt_qlty_insp_id});const e={master:{rm:t.value.rm,prcs_ctrl_id:t.value.prcs_ctrl_id,emp_id:t.value.emp_id,infer_qy:u.value,pass_qy:t.value.pass_qy,insp_qy:t.value.insp_qy,insp_dt:t.value.insp_dt,semi_prdt_qlty_insp_id:t.value.semi_prdt_qlty_insp_id},infer:s};(await I.post("/api/semiPrdtQltyInspUpdate",e).catch(v=>console.log(v))).data.isSuccessed?console.log("완제품 검수 수정이 등록되었습니다."):console.log("완제품 검수 수정에 실패했습니다.")},D=async()=>{const s={semi_prdt_qlty_insp_id:t.value.semi_prdt_qlty_insp_id};(await I.post("/api/semiPrdtQltyInspDelete",s).catch(i=>console.log(i))).data.isSuccessed?console.log("반제품 검수 삭제가 성공되었습니다."):console.log("반제품 검수 삭제가 실패했습니다.")},U=async()=>{t.value.emp_id="",t.value.emp_nm="",t.value.prdt_nm="",t.value.insp_dt=K.dateFormat(new Date,"yyyy-MM-dd"),t.value.insp_qy=0,t.value.note="",t.value.pass_qy=0,t.value.qy=0,t.value.rcs_nm="",t.value.receivedQty="",t.value.rsc_ordr_deta_id="",t.value.rsc_qlty_insp_id="",d.value=[]};return(s,e)=>{const p=y("CInputGroupText"),i=y("CInputGroup"),v=y("CContainer");return q(),Q(v,{fluid:""},{default:a(()=>[n("div",ge,[e[18]||(e[18]=r(" 반제품 품질검사 관리 ",-1)),l(o(F),{color:"secondary",onClick:e[0]||(e[0]=_=>U())},{default:a(()=>[...e[13]||(e[13]=[r("신규",-1)])]),_:1}),l(o(F),{color:"secondary",onClick:e[1]||(e[1]=_=>g())},{default:a(()=>[...e[14]||(e[14]=[r("생산실적조회",-1)])]),_:1}),l(pe,{visible:C.value,onClose:m,onSelect:M},null,8,["visible"]),l(o(F),{color:"secondary",onClick:e[2]||(e[2]=_=>$())},{default:a(()=>[...e[15]||(e[15]=[r("저장",-1)])]),_:1}),l(o(F),{color:"secondary",onClick:e[3]||(e[3]=_=>T())},{default:a(()=>[...e[16]||(e[16]=[r("수정",-1)])]),_:1}),l(o(F),{color:"danger",onClick:e[4]||(e[4]=_=>D())},{default:a(()=>[...e[17]||(e[17]=[r("삭제",-1)])]),_:1})]),l(o(z),{class:"g-3 mb-3"},{default:a(()=>[l(o(w),{md:"3"},{default:a(()=>[l(i,null,{default:a(()=>[l(p,{style:{"min-width":"95px"}},{default:a(()=>[...e[19]||(e[19]=[r("검사자",-1)])]),_:1}),l(o(x),{modelValue:t.value.emp_nm,"onUpdate:modelValue":e[5]||(e[5]=_=>t.value.emp_nm=_),placeholder:"검사자 이름"},null,8,["modelValue"])]),_:1})]),_:1}),l(o(w),{md:"3"},{default:a(()=>[l(i,null,{default:a(()=>[l(p,{style:{"min-width":"95px"}},{default:a(()=>[...e[20]||(e[20]=[r("반제품명",-1)])]),_:1}),l(o(x),{modelValue:t.value.prdt_nm,"onUpdate:modelValue":e[6]||(e[6]=_=>t.value.prdt_nm=_),readonly:"",class:"bg-light"},null,8,["modelValue"])]),_:1})]),_:1}),l(o(w),{md:"3"},{default:a(()=>[l(i,null,{default:a(()=>[l(p,{style:{"min-width":"95px"}},{default:a(()=>[...e[21]||(e[21]=[r("옵션명",-1)])]),_:1}),l(o(x),{modelValue:t.value.opt_nm,"onUpdate:modelValue":e[7]||(e[7]=_=>t.value.opt_nm=_),readonly:"",class:"bg-light"},null,8,["modelValue"])]),_:1})]),_:1}),l(o(w),{md:"3"},{default:a(()=>[l(i,null,{default:a(()=>[l(p,null,{default:a(()=>[...e[22]||(e[22]=[r("실적 수량",-1)])]),_:1}),l(o(x),{modelValue:t.value.qy,"onUpdate:modelValue":e[8]||(e[8]=_=>t.value.qy=_),modelModifiers:{number:!0},readonly:"",type:"number",min:"0",class:"bg-light"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(o(z),{class:"g-3 mb-3"},{default:a(()=>[l(o(w),{md:"3"},{default:a(()=>[l(i,null,{default:a(()=>[l(p,null,{default:a(()=>[...e[23]||(e[23]=[r("검수 수량",-1)])]),_:1}),l(o(x),{modelValue:t.value.insp_qy,"onUpdate:modelValue":e[9]||(e[9]=_=>t.value.insp_qy=_),modelModifiers:{number:!0},type:"number",min:"0"},null,8,["modelValue"])]),_:1})]),_:1}),l(o(w),{md:"3"},{default:a(()=>[l(i,null,{default:a(()=>[l(p,null,{default:a(()=>[...e[24]||(e[24]=[r("합격 수량",-1)])]),_:1}),l(o(x),{value:f.value,readonly:"",type:"number",min:"0",class:"bg-light"},null,8,["value"])]),_:1})]),_:1}),l(o(w),{md:"3"},{default:a(()=>[l(i,null,{default:a(()=>[l(p,{style:{"min-width":"110px"}},{default:a(()=>[...e[25]||(e[25]=[r(" 불량 수량 ",-1)])]),_:1}),l(o(x),{value:u.value,readonly:"",type:"number",class:"bg-light"},null,8,["value"])]),_:1})]),_:1}),l(o(w),{md:"3"},{default:a(()=>[l(i,null,{default:a(()=>[l(p,{style:{"min-width":"110px"}},{default:a(()=>[...e[26]||(e[26]=[r("검사 일자",-1)])]),_:1}),l(o(x),{type:"date",modelValue:t.value.insp_dt,"onUpdate:modelValue":e[10]||(e[10]=_=>t.value.insp_dt=_)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(o(le),{modelValue:t.value.rm,"onUpdate:modelValue":e[11]||(e[11]=_=>t.value.rm=_),label:"비고",rows:"3",text:"필요 시 기재"},null,8,["modelValue"]),n("div",xe,[l(o(F),{color:"secondary",onClick:e[12]||(e[12]=_=>k())},{default:a(()=>[...e[27]||(e[27]=[r("반제품 품질조회",-1)])]),_:1}),l(Ce,{visible:c.value,onClose:N,onSelect:M},null,8,["visible"])]),l(o(se),{hover:"",bordered:"",small:"",class:"align-middle mt-4"},{default:a(()=>[l(o(te),{color:"dark"},{default:a(()=>[l(o(E),null,{default:a(()=>[l(o(R),{class:"text-center"},{default:a(()=>[...e[28]||(e[28]=[r("검사항목",-1)])]),_:1}),l(o(R),{class:"text-center"},{default:a(()=>[...e[29]||(e[29]=[r("기준치",-1)])]),_:1}),l(o(R),{class:"text-center"},{default:a(()=>[...e[30]||(e[30]=[r("오차범위",-1)])]),_:1}),l(o(R),{class:"text-center"},{default:a(()=>[...e[31]||(e[31]=[r("불량수량",-1)])]),_:1})]),_:1})]),_:1}),l(o(ae),null,{default:a(()=>[(q(!0),S(W,null,j(d.value,(_,A)=>(q(),Q(o(E),{key:A},{default:a(()=>[l(o(B),null,{default:a(()=>[r(b(_.insp_item_nm),1)]),_:2},1024),l(o(B),null,{default:a(()=>[r(b(_.basi_val),1)]),_:2},1024),l(o(B),null,{default:a(()=>[r(b(_.eror_scope_min+"~"+_.eror_scope_max),1)]),_:2},1024),l(o(B),{class:"text-start",style:{width:"120px"}},{default:a(()=>[l(o(x),{modelValue:_.infer_qy,"onUpdate:modelValue":X=>_.infer_qy=X,size:"sm",placeholder:"불량수량기입"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128)),d.value.length===0?(q(),Q(o(E),{key:0},{default:a(()=>[l(o(B),{colspan:"4",class:"text-center text-muted py-4"},{default:a(()=>[...e[32]||(e[32]=[r("검사항목이 없습니다.",-1)])]),_:1})]),_:1})):oe("",!0)]),_:1})]),_:1})]),_:1})}}},Pe=Y(Me,[["__scopeId","data-v-22e78995"]]);export{Pe as default};
