import{_ as ee,y as R,r as z,z as j,o as te,D as le,c as g,w as a,f as d,d as l,g as n,e as u,b as q,h as M,F,m as U,a as c,p as ae,t as H,j as k,k as x,v as V,H as oe,x as se}from"./index-TO8iFplr.js";const ne={class:"d-flex justify-content-end mb-3 gap-2"},de={class:"search-filter-box mb-3"},re={class:"d-flex gap-2 mb-2",style:{"min-height":"50px","align-items":"center",padding:"0.8rem 0"}},ue={class:"grid-box flex-grow-1 overflow-hidden d-flex flex-column"},ie={class:"table-wrapper"},me=["onUpdate:modelValue"],pe=["onUpdate:modelValue"],ce=["onUpdate:modelValue"],ye=["onUpdate:modelValue"],_e=["onUpdate:modelValue"],fe=["onUpdate:modelValue"],Ce=["onUpdate:modelValue"],ve={class:"d-flex gap-2 justify-content-end mb-2",style:{"min-height":"50px","align-items":"center",padding:"0.8rem 0"}},be={class:"form-box flex-grow-1 d-flex flex-column overflow-hidden"},ge={class:"p-3 flex-grow-1 overflow-auto"},ke={class:"mb-4"},xe={class:"radio-group-horizontal"},Ve={__name:"qltyItemManage",setup(we){const i=R({itemCode:"",itemName:"",type:""}),o=R({itemCode:"",itemName:"",type:"",version:"",status:"ACT",standard:"",spec:"",unit:"",errorMin:"",errorMax:"",regDate:"",remark:""}),L=[{key:"itemCode",label:"항목코드",type:"text",placeholder:"QI001"},{key:"itemName",label:"항목명",type:"text",placeholder:"항목명을 입력해주세요"},{key:"type",label:"타입",type:"text",placeholder:"정량/정성"},{key:"version",label:"버전",type:"text",placeholder:"v1.0"},{key:"standard",label:"기준치",type:"text",placeholder:"기준치"},{key:"spec",label:"규격",type:"text",placeholder:"규격"},{key:"unit",label:"단위",type:"text",placeholder:"EA"},{key:"errorMin",label:"오차범위(최소)",type:"number",placeholder:"0"},{key:"errorMax",label:"오차범위(최대)",type:"number",placeholder:"0"},{key:"regDate",label:"등록일",type:"date",placeholder:""},{key:"remark",label:"비고",type:"textarea",placeholder:"비고를 입력해주세요"}],y=z([]),w=z(null),h=z(""),S=j(()=>y.value.slice(0,10)),Q=j(()=>{const s=S.value.length;return s<10?10-s:0});te(()=>{document.addEventListener("click",B)}),le(()=>{document.removeEventListener("click",B)});const B=s=>{},I=async()=>{const s={qlty_item_mng_id:i.itemCode||"",insp_item_nm:i.itemName||"",ty:i.type||""};try{let e=await U.get("/api/qlty_item_list_view",{params:s});y.value=(e.data||[]).sort((_,f)=>{const m=parseInt(_.qlty_item_mng_id.replace(/\D/g,""))||0,C=parseInt(f.qlty_item_mng_id.replace(/\D/g,""))||0;return m-C}),w.value=null}catch(e){console.error("조회 오류:",e),y.value=[]}},E=()=>{i.itemCode="",i.itemName="",i.type="",w.value=null,y.value=[]},T=()=>{Object.assign(o,{itemCode:"",itemName:"",type:"",version:"",status:"ACT",standard:"",spec:"",unit:"",errorMin:"",errorMax:"",regDate:"",remark:""}),h.value="",w.value=null},O=()=>{if(console.log("현재 그리드 데이터:",y.value),console.log("그리드 데이터 개수:",y.value.length),y.value.length>0){const s=y.value[y.value.length-1].qlty_item_mng_id;console.log("마지막 ID:",s);const e=s.match(/^QI(\d+)$/);if(e){const f=parseInt(e[1])+1,m=`QI${String(f).padStart(3,"0")}`;return console.log("생성된 새 ID:",m),m}}return console.log("데이터 없음, QI001 반환"),"QI001"},$=(s,e)=>{o.itemCode=s.qlty_item_mng_id,o.itemName=s.insp_item_nm,o.type=s.ty,o.version=s.ver,o.status=s.st,o.standard=s.basi_val,o.spec=s.spec,o.unit=s.unit,o.errorMin=s.eror_scope_min,o.errorMax=s.eror_scope_max,o.regDate=s.reg_dt,o.remark=s.rmrk||"",h.value=s.qlty_item_mng_id,w.value=e},G=()=>{T(),o.itemCode=O(),o.regDate=new Date().toISOString().split("T")[0]},J=async()=>{if(!o.itemName){alert("항목명은 필수 입력 항목입니다.");return}try{const s={insp_item_nm:o.itemName,ty:o.type||"",ver:o.version||"",st:o.status||"ACT",basi_val:o.standard||"",spec:o.spec||"",unit:o.unit||"",eror_scope_min:o.errorMin||"",eror_scope_max:o.errorMax||"",reg_dt:o.regDate||new Date().toISOString().split("T")[0],rmrk:o.remark||""};let e;h.value?(s.qlty_item_mng_id=o.itemCode,s.original_qlty_item_mng_id=h.value,e=await U.post("/api/qltyItemUpdate",s)):e=await U.post("/api/qltyItemInsert",s),e.data.isSuccessed?(alert(e.data.message),await I(),T()):alert(e.data.message)}catch(s){console.error("저장 오류:",s),alert("저장 중 오류가 발생했습니다.")}},K=async()=>{if(!o.itemCode){alert("삭제할 데이터를 선택해주세요.");return}if(confirm("정말 삭제하시겠습니까?"))try{const s=await U.post("/api/qltyItemDelete",{qlty_item_mng_id:o.itemCode});s.data.isSuccessed&&(alert(s.data.message),await I(),T())}catch(s){console.error("삭제 오류:",s),alert("삭제 중 오류가 발생했습니다.")}};return(s,e)=>{const _=u("CButton"),f=u("CFormLabel"),m=u("CFormInput"),C=u("CCol"),D=u("CRow"),b=u("CTableHeaderCell"),N=u("CTableRow"),P=u("CTableHead"),v=u("CTableDataCell"),W=u("CTableBody"),X=u("CTable"),Y=u("CFormTextarea"),A=u("CFormCheck"),Z=u("CContainer");return c(),g(Z,{fluid:"",class:"h-100 d-flex flex-column p-3"},{default:a(()=>[d("div",ne,[l(_,{color:"secondary",size:"sm",onClick:I,class:"btn-search"},{default:a(()=>[...e[12]||(e[12]=[n("조회",-1)])]),_:1}),l(_,{color:"secondary",size:"sm",onClick:E,class:"btn-reset"},{default:a(()=>[...e[13]||(e[13]=[n("초기화",-1)])]),_:1})]),d("div",de,[l(D,{class:"g-3"},{default:a(()=>[l(C,{md:4},{default:a(()=>[l(f,{class:"form-label"},{default:a(()=>[...e[14]||(e[14]=[n("항목코드",-1)])]),_:1}),l(m,{modelValue:i.itemCode,"onUpdate:modelValue":e[0]||(e[0]=t=>i.itemCode=t),size:"sm",placeholder:"입력해주세요",class:"form-input-enhanced"},null,8,["modelValue"])]),_:1}),l(C,{md:4},{default:a(()=>[l(f,{class:"form-label"},{default:a(()=>[...e[15]||(e[15]=[n("항목명",-1)])]),_:1}),l(m,{modelValue:i.itemName,"onUpdate:modelValue":e[1]||(e[1]=t=>i.itemName=t),size:"sm",placeholder:"입력해주세요",class:"form-input-enhanced"},null,8,["modelValue"])]),_:1}),l(C,{md:4},{default:a(()=>[l(f,{class:"form-label"},{default:a(()=>[...e[16]||(e[16]=[n("타입",-1)])]),_:1}),l(m,{modelValue:i.type,"onUpdate:modelValue":e[2]||(e[2]=t=>i.type=t),size:"sm",placeholder:"입력해주세요",class:"form-input-enhanced"},null,8,["modelValue"])]),_:1})]),_:1})]),l(D,{class:"flex-grow-1 overflow-hidden g-2"},{default:a(()=>[l(C,{md:7,class:"d-flex flex-column overflow-hidden pe-1"},{default:a(()=>[d("div",re,[l(_,{color:"secondary",size:"sm",class:"btn-hidden",style:{visibility:"hidden"}},{default:a(()=>[...e[17]||(e[17]=[n("숨김",-1)])]),_:1})]),d("div",ue,[d("div",ie,[l(X,{bordered:"",hover:"",class:"data-table"},{default:a(()=>[l(P,null,{default:a(()=>[l(N,null,{default:a(()=>[l(b,{style:{width:"12%"}},{default:a(()=>[...e[18]||(e[18]=[n("항목코드",-1)])]),_:1}),l(b,{style:{width:"18%"}},{default:a(()=>[...e[19]||(e[19]=[n("항목명",-1)])]),_:1}),l(b,{style:{width:"12%"}},{default:a(()=>[...e[20]||(e[20]=[n("타입",-1)])]),_:1}),l(b,{style:{width:"10%"}},{default:a(()=>[...e[21]||(e[21]=[n("버전",-1)])]),_:1}),l(b,{style:{width:"10%"}},{default:a(()=>[...e[22]||(e[22]=[n("상태",-1)])]),_:1}),l(b,{style:{width:"13%"}},{default:a(()=>[...e[23]||(e[23]=[n("기준치",-1)])]),_:1}),l(b,{style:{width:"13%"}},{default:a(()=>[...e[24]||(e[24]=[n("규격",-1)])]),_:1}),l(b,{style:{width:"12%"}},{default:a(()=>[...e[25]||(e[25]=[n("단위",-1)])]),_:1})]),_:1})]),_:1}),l(W,null,{default:a(()=>[(c(!0),q(F,null,M(S.value,(t,p)=>(c(),g(N,{key:p,onClick:r=>$(t,p),class:ae([{"selected-row":w.value===p},"data-row"])},{default:a(()=>[l(v,{class:"text-end text-primary"},{default:a(()=>[n(H(t.qlty_item_mng_id),1)]),_:2},1024),l(v,null,{default:a(()=>[k(d("input",{"onUpdate:modelValue":r=>t.insp_item_nm=r,class:"cell-input",onClick:e[3]||(e[3]=x(()=>{},["stop"]))},null,8,me),[[V,t.insp_item_nm]])]),_:2},1024),l(v,null,{default:a(()=>[k(d("input",{"onUpdate:modelValue":r=>t.ty=r,class:"cell-input",onClick:e[4]||(e[4]=x(()=>{},["stop"]))},null,8,pe),[[V,t.ty]])]),_:2},1024),l(v,null,{default:a(()=>[k(d("input",{"onUpdate:modelValue":r=>t.ver=r,class:"cell-input",onClick:e[5]||(e[5]=x(()=>{},["stop"]))},null,8,ce),[[V,t.ver]])]),_:2},1024),l(v,null,{default:a(()=>[k(d("select",{"onUpdate:modelValue":r=>t.st=r,class:"cell-input",onClick:e[6]||(e[6]=x(()=>{},["stop"]))},[...e[26]||(e[26]=[d("option",{value:"ACT"},"사용",-1),d("option",{value:"INACT"},"미사용",-1)])],8,ye),[[oe,t.st]])]),_:2},1024),l(v,null,{default:a(()=>[k(d("input",{"onUpdate:modelValue":r=>t.basi_val=r,class:"cell-input",onClick:e[7]||(e[7]=x(()=>{},["stop"]))},null,8,_e),[[V,t.basi_val]])]),_:2},1024),l(v,null,{default:a(()=>[k(d("input",{"onUpdate:modelValue":r=>t.spec=r,class:"cell-input",onClick:e[8]||(e[8]=x(()=>{},["stop"]))},null,8,fe),[[V,t.spec]])]),_:2},1024),l(v,null,{default:a(()=>[k(d("input",{"onUpdate:modelValue":r=>t.unit=r,class:"cell-input",onClick:e[9]||(e[9]=x(()=>{},["stop"]))},null,8,Ce),[[V,t.unit]])]),_:2},1024)]),_:2},1032,["onClick","class"]))),128)),(c(!0),q(F,null,M(Q.value,t=>(c(),g(N,{key:"empty-"+t,class:"empty-row"},{default:a(()=>[l(v,{colspan:"8"},{default:a(()=>[...e[27]||(e[27]=[n(" ",-1)])]),_:1})]),_:1}))),128))]),_:1})]),_:1})])])]),_:1}),l(C,{md:5,class:"d-flex flex-column overflow-hidden ps-1"},{default:a(()=>[d("div",ve,[l(_,{color:"secondary",size:"sm",onClick:G,class:"btn-action"},{default:a(()=>[...e[28]||(e[28]=[n("신규",-1)])]),_:1}),l(_,{color:"secondary",size:"sm",onClick:J,class:"btn-action"},{default:a(()=>[...e[29]||(e[29]=[n("저장",-1)])]),_:1}),l(_,{color:"danger",size:"sm",onClick:K,class:"btn-action"},{default:a(()=>[...e[30]||(e[30]=[n("삭제",-1)])]),_:1})]),d("div",be,[d("div",ge,[l(D,{class:"g-3"},{default:a(()=>[l(C,{md:7},{default:a(()=>[(c(),q(F,null,M(L,t=>d("div",{key:t.key,class:"form-row-horizontal mb-2"},[l(f,{class:"form-label-inline"},{default:a(()=>[n(H(t.label),1)]),_:2},1024),t.type==="text"?(c(),g(m,{key:0,modelValue:o[t.key],"onUpdate:modelValue":p=>o[t.key]=p,size:"sm",placeholder:t.placeholder,disabled:t.key==="itemCode",class:"form-input-enhanced"},null,8,["modelValue","onUpdate:modelValue","placeholder","disabled"])):t.type==="number"?(c(),g(m,{key:1,modelValue:o[t.key],"onUpdate:modelValue":p=>o[t.key]=p,type:"number",size:"sm",placeholder:t.placeholder,class:"form-input-enhanced"},null,8,["modelValue","onUpdate:modelValue","placeholder"])):t.type==="date"?(c(),g(m,{key:2,modelValue:o[t.key],"onUpdate:modelValue":p=>o[t.key]=p,type:"date",size:"sm",class:"form-input-enhanced"},null,8,["modelValue","onUpdate:modelValue"])):t.type==="textarea"?(c(),g(Y,{key:3,modelValue:o[t.key],"onUpdate:modelValue":p=>o[t.key]=p,size:"sm",rows:"2",placeholder:t.placeholder,class:"form-input-enhanced",style:{height:"auto",width:"180px","max-width":"180px"}},null,8,["modelValue","onUpdate:modelValue","placeholder"])):se("",!0)])),64))]),_:1}),l(C,{md:5,class:"d-flex flex-column justify-content-center"},{default:a(()=>[d("div",ke,[l(f,{class:"form-label-radio"},{default:a(()=>[...e[31]||(e[31]=[n("상태",-1)])]),_:1}),d("div",xe,[l(A,{type:"radio",name:"status",label:"사용",value:"ACT",modelValue:o.status,"onUpdate:modelValue":e[10]||(e[10]=t=>o.status=t),class:"radio-item-inline"},null,8,["modelValue"]),l(A,{type:"radio",name:"status",label:"미사용",value:"INACT",modelValue:o.status,"onUpdate:modelValue":e[11]||(e[11]=t=>o.status=t),class:"radio-item-inline"},null,8,["modelValue"])])])]),_:1})]),_:1})])])]),_:1})]),_:1})]),_:1})}}},Ue=ee(Ve,[["__scopeId","data-v-b5fee195"]]);export{Ue as default};
