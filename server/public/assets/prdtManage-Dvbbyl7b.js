import{_ as ue,y as pe,r as N,z as D,o as ie,m as C,c as z,w as l,f as r,d as t,g as a,e as c,b as L,h as B,F as M,a as w,p as G,k as y,t as A,j as x,v as k,H as ce}from"./index-TO8iFplr.js";const fe={class:"d-flex justify-content-end gap-2 mb-2"},_e={class:"search-filter-box mb-2"},me={class:"d-flex justify-content-end gap-2"},ve={class:"grid-box flex-grow-1 overflow-hidden"},ye={class:"table-wrapper"},ge=["onUpdate:modelValue"],we=["onUpdate:modelValue"],Ce=["onUpdate:modelValue"],xe=["onUpdate:modelValue"],ke=["onUpdate:modelValue"],Ve={class:"d-flex justify-content-end gap-2"},he={class:"grid-box flex-grow-1 overflow-hidden"},be={class:"table-wrapper"},Ue=["onUpdate:modelValue"],Ne=["onUpdate:modelValue"],De=["onUpdate:modelValue"],Ie={__name:"prdtManage",setup(Re){const f=pe({productId:"",productName:"",productStatus:""}),m=N([]),V=N(null),_=N(null),v=N([]),h=N(null),I=N(null),R=D(()=>m.value.slice(0,10)),q=D(()=>Math.max(0,10-R.value.length)),T=D(()=>v.value.slice(0,10)),J=D(()=>Math.max(0,10-T.value.length)),H=D(()=>R.value.length>0&&R.value.every(o=>o.selected)),K=D(()=>T.value.length>0&&T.value.every(o=>o.selected)),Q=()=>{const o=!H.value;R.value.forEach(e=>{e.selected=o})},W=()=>{const o=!K.value;T.value.forEach(e=>{e.selected=o})};ie(()=>{E()});const X=(o,e)=>{V.value=e,_.value=o.prdt_id,console.log("좌측 제품 선택:",o.prdt_id),o.prdt_id&&$(o.prdt_id)},Z=(o,e)=>{h.value=e,I.value=o.opt_id,console.log("우측 옵션 선택:",o.opt_id)},$=async o=>{try{console.log("📋 우측 옵션 조회:",o);const e=await C.get("/api/prdt_option_list",{params:{prdt_id:o}}),n=Array.isArray(e.data)?e.data:e.data.data||[];v.value=n.map(p=>({...p,selected:!1})),console.log("✅ 우측 옵션 조회 완료:",v.value.length,"건"),h.value=null,I.value=null}catch(e){console.error("❌ 우측 옵션 조회 오류:",e),v.value=[]}},E=async()=>{try{const o={prdt_id:f.productId||"",prdt_nm:f.productName||"",prdt_st:f.productStatus||"K1"};console.log("📋 조회 파라미터:",o);const e=await C.get("/api/prdt_list_view",{params:o}),n=Array.isArray(e.data)?e.data:e.data.data||[];m.value=n.map(p=>({...p,selected:!1})),console.log("✅ 좌측 조회 완료:",m.value.length,"건"),V.value=null,_.value=null}catch(o){console.error("❌ 좌측 조회 오류:",o),m.value=[]}},ee=()=>{f.productId="",f.productName="",f.productStatus="",V.value=null,_.value=null,h.value=null,I.value=null,m.value=[],v.value=[],console.log("🔄 초기화 완료")},te=async()=>{const o={prdt_id:"",prdt_nm:"",spec:"",unit:"",prdt_st:"K1",rmrk:"",selected:!1,isNew:!0};m.value.unshift(o),V.value=0,_.value=null,console.log("➕ 좌측 신규 행 추가")},le=async()=>{const o=m.value.filter(e=>e.isNew||e.selected);if(o.length===0){alert("저장할 항목이 없습니다.");return}try{for(const e of o){if(!e.prdt_nm){alert("제품명을 입력해주세요.");continue}const n={prdt_nm:e.prdt_nm,spec:e.spec||"",unit:e.unit||"",prdt_st:e.prdt_st||"K1",rm:e.rmrk||""};e.isNew?(console.log("➕ 좌측 신규 등록:",n),await C.post("/api/prdtInsert",n)):(n.prdt_id=e.prdt_id,n.original_prdt_id=e.prdt_id,console.log("✏️ 좌측 수정:",n),await C.post("/api/prdtUpdate",n))}alert("저장 완료"),await E()}catch(e){console.error("❌ 좌측 저장 오류:",e),alert("저장 중 오류가 발생했습니다.")}},oe=async()=>{const o=m.value.filter(e=>e.selected);if(o.length===0){alert("삭제할 항목을 선택해주세요.");return}if(confirm(`${o.length}개 항목을 삭제하시겠습니까?`))try{for(const e of o)!e.isNew&&e.prdt_id&&(console.log("🗑️ 좌측 삭제:",e.prdt_id),await C.post("/api/prdtDelete",{prdt_id:e.prdt_id}));m.value=m.value.filter(e=>!e.selected),alert("삭제되었습니다."),V.value=null,_.value=null}catch(e){console.error("❌ 좌측 삭제 오류:",e),alert("삭제 중 오류가 발생했습니다.")}},se=()=>{if(!_.value){alert("좌측에서 제품을 먼저 선택해주세요.");return}const o={opt_id:"",prdt_id:_.value,opt_nm:"",use_yn:!0,rm:"",selected:!1,isNew:!0};v.value.unshift(o),h.value=0,I.value=null,console.log("➕ 우측 신규 행 추가 (제품ID:",_.value,")")},ae=async()=>{if(!_.value){alert("좌측에서 제품을 먼저 선택해주세요.");return}const o=v.value.filter(e=>e.isNew||e.selected);if(o.length===0){alert("저장할 항목이 없습니다.");return}try{for(const e of o){if(!e.opt_nm){alert("옵션명을 입력해주세요.");continue}const n=e.use_yn===!0||e.use_yn==="Y"||e.use_yn==="사용"?"Y":"N",p={prdt_id:_.value,opt_nm:e.opt_nm,use_yn:n,rm:e.rm||""};if(e.isNew){console.log("➕ 우측 신규 등록:",p);const b=await C.post("/api/optionInsert",p);console.log("응답:",b.data)}else{p.opt_id=e.opt_id,p.original_opt_id=e.opt_id,console.log("✏️ 우측 수정:",p);const b=await C.post("/api/optionUpdate",p);console.log("응답:",b.data)}}alert("우측 저장 완료"),await $(_.value)}catch(e){console.error("❌ 우측 저장 오류 상세:",e),console.error("오류 응답:",e.response?.data),console.error("오류 상태:",e.response?.status),alert(`저장 중 오류가 발생했습니다.
${e.response?.data?.message||e.message}`)}},ne=async()=>{const o=v.value.filter(e=>e.selected);if(o.length===0){alert("삭제할 항목을 선택해주세요.");return}if(confirm(`${o.length}개 항목을 삭제하시겠습니까?`))try{for(const e of o)!e.isNew&&e.opt_id&&(console.log("🗑️ 우측 삭제:",e.opt_id),await C.post("/api/optionDelete",{opt_id:e.opt_id}));v.value=v.value.filter(e=>!e.selected),alert("삭제되었습니다."),h.value=null,I.value=null}catch(e){console.error("❌ 우측 삭제 오류:",e),alert("삭제 중 오류가 발생했습니다.")}};return(o,e)=>{const n=c("CButton"),p=c("CFormLabel"),b=c("CFormInput"),S=c("CCol"),de=c("CFormSelect"),j=c("CRow"),F=c("CFormCheck"),i=c("CTableHeaderCell"),U=c("CTableRow"),O=c("CTableHead"),u=c("CTableDataCell"),P=c("CTableBody"),Y=c("CTable"),re=c("CContainer");return w(),z(re,{fluid:"",class:"h-100 d-flex flex-column p-3"},{default:l(()=>[r("div",fe,[t(n,{color:"secondary",size:"sm",onClick:E},{default:l(()=>[...e[13]||(e[13]=[a("조회",-1)])]),_:1}),t(n,{color:"secondary",size:"sm",onClick:ee},{default:l(()=>[...e[14]||(e[14]=[a("초기화",-1)])]),_:1})]),r("div",_e,[t(j,{class:"g-2 align-items-end"},{default:l(()=>[t(S,{md:3},{default:l(()=>[t(p,{class:"form-label"},{default:l(()=>[...e[15]||(e[15]=[a("제품ID",-1)])]),_:1}),t(b,{modelValue:f.productId,"onUpdate:modelValue":e[0]||(e[0]=s=>f.productId=s),size:"sm",placeholder:"제품ID 입력"},null,8,["modelValue"])]),_:1}),t(S,{md:4},{default:l(()=>[t(p,{class:"form-label"},{default:l(()=>[...e[16]||(e[16]=[a("제품명",-1)])]),_:1}),t(b,{modelValue:f.productName,"onUpdate:modelValue":e[1]||(e[1]=s=>f.productName=s),size:"sm",placeholder:"제품명 입력"},null,8,["modelValue"])]),_:1}),t(S,{md:3},{default:l(()=>[t(p,{class:"form-label"},{default:l(()=>[...e[17]||(e[17]=[a("제품상태",-1)])]),_:1}),t(de,{modelValue:f.productStatus,"onUpdate:modelValue":e[2]||(e[2]=s=>f.productStatus=s),size:"sm"},{default:l(()=>[...e[18]||(e[18]=[r("option",{value:""},"전체",-1),r("option",{value:"K1"},"생산가능",-1),r("option",{value:"K2"},"생산불가",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),t(j,{class:"flex-grow-1 overflow-hidden g-2"},{default:l(()=>[t(S,{md:6,class:"d-flex flex-column overflow-hidden gap-2"},{default:l(()=>[r("div",me,[t(n,{color:"secondary",size:"sm",onClick:te},{default:l(()=>[...e[19]||(e[19]=[a("신규",-1)])]),_:1}),t(n,{color:"secondary",size:"sm",onClick:le},{default:l(()=>[...e[20]||(e[20]=[a("저장",-1)])]),_:1}),t(n,{color:"danger",size:"sm",onClick:oe},{default:l(()=>[...e[21]||(e[21]=[a("선택삭제",-1)])]),_:1})]),r("div",ve,[r("div",ye,[t(Y,{bordered:"",hover:"",class:"data-table"},{default:l(()=>[t(O,null,{default:l(()=>[t(U,null,{default:l(()=>[t(i,{style:{width:"30px"}},{default:l(()=>[t(F,{checked:H.value,onChange:Q},null,8,["checked"])]),_:1}),t(i,{style:{width:"40px"}},{default:l(()=>[...e[22]||(e[22]=[a("No",-1)])]),_:1}),t(i,{style:{width:"80px"}},{default:l(()=>[...e[23]||(e[23]=[a("제품ID",-1)])]),_:1}),t(i,{style:{width:"120px"}},{default:l(()=>[...e[24]||(e[24]=[a("제품명",-1)])]),_:1}),t(i,{style:{width:"80px"}},{default:l(()=>[...e[25]||(e[25]=[a("규격",-1)])]),_:1}),t(i,{style:{width:"60px"}},{default:l(()=>[...e[26]||(e[26]=[a("단위",-1)])]),_:1}),t(i,{style:{width:"100px"}},{default:l(()=>[...e[27]||(e[27]=[a("제품상태",-1)])]),_:1}),t(i,{style:{width:"100px"}},{default:l(()=>[...e[28]||(e[28]=[a("비고",-1)])]),_:1})]),_:1})]),_:1}),t(P,null,{default:l(()=>[(w(!0),L(M,null,B(R.value,(s,g)=>(w(),z(U,{key:g,class:G({"selected-row":V.value===g}),onClick:d=>X(s,g)},{default:l(()=>[t(u,{class:"text-center",style:{width:"30px"}},{default:l(()=>[t(F,{modelValue:s.selected,"onUpdate:modelValue":d=>s.selected=d,onClick:e[3]||(e[3]=y(()=>{},["stop"]))},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(u,{class:"text-end",style:{width:"40px"}},{default:l(()=>[a(A(g+1),1)]),_:2},1024),t(u,{class:"text-end text-primary",style:{width:"80px"}},{default:l(()=>[a(A(s.prdt_id),1)]),_:2},1024),t(u,{class:"text-start",style:{width:"120px"}},{default:l(()=>[x(r("input",{"onUpdate:modelValue":d=>s.prdt_nm=d,class:"cell-input",onClick:e[4]||(e[4]=y(()=>{},["stop"]))},null,8,ge),[[k,s.prdt_nm]])]),_:2},1024),t(u,{class:"text-start",style:{width:"80px"}},{default:l(()=>[x(r("input",{"onUpdate:modelValue":d=>s.spec=d,class:"cell-input",onClick:e[5]||(e[5]=y(()=>{},["stop"]))},null,8,we),[[k,s.spec]])]),_:2},1024),t(u,{class:"text-start",style:{width:"60px"}},{default:l(()=>[x(r("input",{"onUpdate:modelValue":d=>s.unit=d,class:"cell-input",onClick:e[6]||(e[6]=y(()=>{},["stop"]))},null,8,Ce),[[k,s.unit]])]),_:2},1024),t(u,{class:"text-start",style:{width:"100px"}},{default:l(()=>[x(r("input",{"onUpdate:modelValue":d=>s.prdt_st=d,class:"cell-input",onClick:e[7]||(e[7]=y(()=>{},["stop"]))},null,8,xe),[[k,s.prdt_st]])]),_:2},1024),t(u,{class:"text-start"},{default:l(()=>[x(r("input",{"onUpdate:modelValue":d=>s.rmrk=d,class:"cell-input",onClick:e[8]||(e[8]=y(()=>{},["stop"]))},null,8,ke),[[k,s.rmrk]])]),_:2},1024)]),_:2},1032,["class","onClick"]))),128)),(w(!0),L(M,null,B(q.value,s=>(w(),z(U,{key:"empty-"+s,class:"empty-row"},{default:l(()=>[t(u,{colspan:"8"},{default:l(()=>[...e[29]||(e[29]=[a(" ",-1)])]),_:1})]),_:1}))),128))]),_:1})]),_:1})])])]),_:1}),t(S,{md:6,class:"d-flex flex-column overflow-hidden gap-2"},{default:l(()=>[r("div",Ve,[t(n,{color:"secondary",size:"sm",onClick:se},{default:l(()=>[...e[30]||(e[30]=[a("신규",-1)])]),_:1}),t(n,{color:"secondary",size:"sm",onClick:ae},{default:l(()=>[...e[31]||(e[31]=[a("저장",-1)])]),_:1}),t(n,{color:"danger",size:"sm",onClick:ne},{default:l(()=>[...e[32]||(e[32]=[a("선택삭제",-1)])]),_:1})]),r("div",he,[r("div",be,[t(Y,{bordered:"",hover:"",class:"data-table"},{default:l(()=>[t(O,null,{default:l(()=>[t(U,null,{default:l(()=>[t(i,{style:{width:"30px"}},{default:l(()=>[t(F,{checked:K.value,onChange:W},null,8,["checked"])]),_:1}),t(i,{style:{width:"40px"}},{default:l(()=>[...e[33]||(e[33]=[a("No",-1)])]),_:1}),t(i,{style:{width:"80px"}},{default:l(()=>[...e[34]||(e[34]=[a("옵션ID",-1)])]),_:1}),t(i,null,{default:l(()=>[...e[35]||(e[35]=[a("옵션명",-1)])]),_:1}),t(i,null,{default:l(()=>[...e[36]||(e[36]=[a("사용여부",-1)])]),_:1}),t(i,null,{default:l(()=>[...e[37]||(e[37]=[a("비고",-1)])]),_:1})]),_:1})]),_:1}),t(P,null,{default:l(()=>[(w(!0),L(M,null,B(T.value,(s,g)=>(w(),z(U,{key:g,class:G({"selected-row":h.value===g}),onClick:d=>Z(s,g)},{default:l(()=>[t(u,{class:"text-center",style:{width:"30px"}},{default:l(()=>[t(F,{modelValue:s.selected,"onUpdate:modelValue":d=>s.selected=d,onClick:e[9]||(e[9]=y(()=>{},["stop"]))},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(u,{class:"text-end",style:{width:"40px"}},{default:l(()=>[a(A(g+1),1)]),_:2},1024),t(u,{class:"text-start",style:{width:"80px"}},{default:l(()=>[a(A(s.opt_id),1)]),_:2},1024),t(u,{class:"text-start"},{default:l(()=>[x(r("input",{"onUpdate:modelValue":d=>s.opt_nm=d,class:"cell-input",onClick:e[10]||(e[10]=y(()=>{},["stop"]))},null,8,Ue),[[k,s.opt_nm]])]),_:2},1024),t(u,{class:"text-start"},{default:l(()=>[x(r("select",{"onUpdate:modelValue":d=>s.use_yn=d,class:"cell-input",onClick:e[11]||(e[11]=y(()=>{},["stop"]))},[...e[38]||(e[38]=[r("option",{value:!0},"사용",-1),r("option",{value:!1},"미사용",-1)])],8,Ne),[[ce,s.use_yn]])]),_:2},1024),t(u,{class:"text-start"},{default:l(()=>[x(r("input",{"onUpdate:modelValue":d=>s.rm=d,class:"cell-input",onClick:e[12]||(e[12]=y(()=>{},["stop"]))},null,8,De),[[k,s.rm]])]),_:2},1024)]),_:2},1032,["class","onClick"]))),128)),(w(!0),L(M,null,B(J.value,s=>(w(),z(U,{key:"empty-right-"+s,class:"empty-row"},{default:l(()=>[t(u,{colspan:"6"},{default:l(()=>[...e[39]||(e[39]=[a(" ",-1)])]),_:1})]),_:1}))),128))]),_:1})]),_:1})])])]),_:1})]),_:1})]),_:1})}}},Se=ue(Ie,[["__scopeId","data-v-83c034d3"]]);export{Se as default};
