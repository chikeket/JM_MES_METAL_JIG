import{_ as se,y as B,r as g,z as E,o as oe,m as x,c as Q,w as t,f as i,d as l,g as n,e as u,b as q,h as M,F as T,E as ne,a as v,t as k,p as de}from"./index-TO8iFplr.js";const me={class:"d-flex justify-content-end mb-2 gap-2"},re={class:"search-filter-box mb-2"},ue=["value"],pe=["value"],_e={class:"button-spacer mb-2"},fe={class:"grid-box flex-grow-1 overflow-hidden d-flex flex-column"},ie={class:"d-flex justify-content-end gap-2 mb-2"},ce={class:"form-box flex-grow-1 d-flex flex-column overflow-hidden"},ge={class:"p-3 flex-grow-1 overflow-auto"},ke={class:"radio-group"},ye={__name:"Eqm",setup(be){const p=B({eqm_grp_nm:"",eqm_nm:"",make_co:"",st:""}),w=g([]),F=g([]),D=g([]),c=g(null),C=g(null),s=B({eqm_grp_nm:"",eqm_nm:"",make_model:"",make_co:"",make_dt:"",setp_dt:"",chck_cycle:"",st:"M2",rm:""}),U=g(!1),$=E(()=>w.value);E(()=>0);const G=g(12),L=g(36),W=g(44),j=E(()=>{const a=Math.max(1,Math.min(G.value,$.value.length||0));return{height:"auto",maxHeight:`${W.value+L.value*a}px`}}),S=async()=>{try{const{data:a}=await x.get("/api/eqm",{params:p});w.value=Array.isArray(a)?a:[],C.value=null}catch(a){console.error("[eqm] 조회 에러:",a),alert("설비 목록 조회 중 오류가 발생했습니다.")}},O=()=>{p.eqm_grp_nm="",p.eqm_nm="",p.make_co="",p.st="",C.value=null,w.value=[],V()},P=(a,e)=>{c.value=a,C.value=e,U.value=!0,s.eqm_grp_nm=a.eqm_grp_nm||"",s.eqm_nm=a.eqm_nm,s.make_co=a.make_co||"",s.st=K(a.st,a.st_nm),s.make_model=a.make_model||"",s.make_dt=H(a.make_dt),s.setp_dt=H(a.setp_dt),s.chck_cycle=a.chck_cycle??"",s.rm=a.rm||""},V=()=>{c.value=null,C.value=null,U.value=!1,s.eqm_grp_nm="",s.eqm_nm="",s.make_model="",s.make_co="",s.make_dt="",s.setp_dt="",s.chck_cycle="",s.st="M2",s.rm=""},Y=async()=>{try{if(!s.eqm_nm||!String(s.eqm_nm).trim()){alert("설비명을 입력해주세요.");return}const a={eqm_grp_nm:s.eqm_grp_nm||null,eqm_nm:String(s.eqm_nm).trim(),make_co:s.make_co||null,make_model:s.make_model||null,make_dt:s.make_dt||null,setp_dt:s.setp_dt||null,chck_cycle:s.chck_cycle||null,st:Z(s.st),rm:s.rm||null};let e;if(c.value&&c.value.eqm_id?e=await x.put(`/api/eqm/${c.value.eqm_id}`,a):e=await x.post("/api/eqm",a),e?.data?.success===!1)throw new Error(e.data.message||"저장 실패");alert("저장되었습니다."),await S(),V()}catch(a){console.error("[eqm] 저장 에러:",a),alert(a?.response?.data?.message||a.message||"설비 저장 중 오류가 발생했습니다.")}},X=async()=>{try{if(!c.value||!c.value.eqm_id||!confirm("선택한 설비를 삭제하시겠습니까?"))return;const e=await x.delete(`/api/eqm/${c.value.eqm_id}`);if(e?.data?.success===!1)throw new Error(e.data.message||"삭제 실패");alert("삭제되었습니다."),await S(),V()}catch(a){console.error("[eqm] 삭제 에러:",a),alert(a?.response?.data?.message||a.message||"설비 삭제 중 오류가 발생했습니다.")}};oe(async()=>{try{const[a,e]=await Promise.all([x.get("/api/eqm/make-companies"),x.get("/api/eqm/statuses")]);F.value=Array.isArray(a.data)?a.data:[],D.value=Array.isArray(e.data)?e.data:[]}catch(a){console.warn("[eqm] 드롭다운 초기화 실패",a)}});const J=a=>({E1:"프레스월드",E2:"사출코",E3:"라인메이커",E4:"비전텍",E5:"예담"})[a]||a||"",R=a=>{if(!a)return"";try{const e=new Date(a);if(Number.isNaN(e.getTime()))return String(a);const m=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),_=String(e.getDate()).padStart(2,"0");return`${m}-${r}-${_}`}catch{return String(a)}},H=a=>{if(!a)return"";const e=new Date(a);if(!Number.isNaN(e.getTime())){const r=e.getFullYear(),_=String(e.getMonth()+1).padStart(2,"0"),d=String(e.getDate()).padStart(2,"0");return`${r}-${_}-${d}`}const m=String(a);return m.length===8&&/^\d{8}$/.test(m)?`${m.slice(0,4)}-${m.slice(4,6)}-${m.slice(6,8)}`:""},K=(a,e)=>{const m=String(a||"").trim();if(m==="Q1")return"M2";if(m==="Q2")return"M1";if(m==="M1"||m==="M2")return m;const r=String(e||"").trim();return r.includes("비가동")?"M1":(r.includes("가동"),"M2")},Z=a=>{const e=String(a||"").trim();return e==="M2"?"Q1":e==="M1"?"Q2":e==="Q1"||e==="Q2"?e:"Q1"};return(a,e)=>{const m=u("CButton"),r=u("CFormLabel"),_=u("CFormInput"),d=u("CCol"),I=u("CFormSelect"),f=u("CRow"),y=u("CTableHeaderCell"),N=u("CTableRow"),h=u("CTableHead"),b=u("CTableDataCell"),ee=u("CTableBody"),le=u("CTable"),A=u("CFormCheck"),te=u("CFormTextarea"),ae=u("CContainer");return v(),Q(ae,{fluid:"",class:"h-100 d-flex flex-column p-3"},{default:t(()=>[i("div",me,[l(m,{color:"secondary",size:"sm",onClick:S},{default:t(()=>[...e[14]||(e[14]=[n("조회",-1)])]),_:1}),l(m,{color:"secondary",size:"sm",onClick:O},{default:t(()=>[...e[15]||(e[15]=[n("초기화",-1)])]),_:1})]),i("div",re,[l(f,{class:"g-3"},{default:t(()=>[l(d,{md:3},{default:t(()=>[l(r,{class:"form-label"},{default:t(()=>[...e[16]||(e[16]=[n("설비 그룹 명",-1)])]),_:1}),l(_,{modelValue:p.eqm_grp_nm,"onUpdate:modelValue":e[0]||(e[0]=o=>p.eqm_grp_nm=o),size:"sm",placeholder:"설비그룹명을 입력하세요"},null,8,["modelValue"])]),_:1}),l(d,{md:3},{default:t(()=>[l(r,{class:"form-label"},{default:t(()=>[...e[17]||(e[17]=[n("설비 명",-1)])]),_:1}),l(_,{modelValue:p.eqm_nm,"onUpdate:modelValue":e[1]||(e[1]=o=>p.eqm_nm=o),size:"sm",placeholder:"설비명을 입력하세요"},null,8,["modelValue"])]),_:1}),l(d,{md:3},{default:t(()=>[l(r,{class:"form-label"},{default:t(()=>[...e[18]||(e[18]=[n("제조 회사",-1)])]),_:1}),l(I,{modelValue:p.make_co,"onUpdate:modelValue":e[2]||(e[2]=o=>p.make_co=o),size:"sm"},{default:t(()=>[e[19]||(e[19]=i("option",{value:""},"전체",-1)),(v(!0),q(T,null,M(F.value,o=>(v(),q("option",{key:o,value:o},k(J(o)),9,ue))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{md:3},{default:t(()=>[l(r,{class:"form-label"},{default:t(()=>[...e[20]||(e[20]=[n("상태",-1)])]),_:1}),l(I,{modelValue:p.st,"onUpdate:modelValue":e[3]||(e[3]=o=>p.st=o),size:"sm"},{default:t(()=>[e[21]||(e[21]=i("option",{value:""},"전체",-1)),(v(!0),q(T,null,M(D.value,o=>(v(),q("option",{key:o.st,value:o.st},k(o.st_nm),9,pe))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),l(f,{class:"flex-grow-1 overflow-hidden g-2 main-content-row"},{default:t(()=>[l(d,{md:6,class:"d-flex flex-column overflow-hidden left-pane"},{default:t(()=>[i("div",_e,[l(m,{color:"secondary",size:"sm"},{default:t(()=>[...e[22]||(e[22]=[n("신규",-1)])]),_:1}),l(m,{color:"secondary",size:"sm"},{default:t(()=>[...e[23]||(e[23]=[n("저장",-1)])]),_:1}),l(m,{color:"danger",size:"sm"},{default:t(()=>[...e[24]||(e[24]=[n("삭제",-1)])]),_:1})]),i("div",fe,[i("div",{class:"table-wrapper",style:ne(j.value)},[l(le,{bordered:"",hover:"",class:"data-table"},{default:t(()=>[l(h,null,{default:t(()=>[l(N,null,{default:t(()=>[l(y,{scope:"col",class:"text-center",style:{width:"60px"}},{default:t(()=>[...e[25]||(e[25]=[n("No",-1)])]),_:1}),l(y,{scope:"col",class:"text-center"},{default:t(()=>[...e[26]||(e[26]=[n("설비 명",-1)])]),_:1}),l(y,{scope:"col",class:"text-center"},{default:t(()=>[...e[27]||(e[27]=[n("제조 모델",-1)])]),_:1}),l(y,{scope:"col",class:"text-center"},{default:t(()=>[...e[28]||(e[28]=[n("제조 일자",-1)])]),_:1}),l(y,{scope:"col",class:"text-center"},{default:t(()=>[...e[29]||(e[29]=[n("설치 일자",-1)])]),_:1}),l(y,{scope:"col",class:"text-center",style:{width:"100px"}},{default:t(()=>[...e[30]||(e[30]=[n("상태",-1)])]),_:1}),l(y,{scope:"col",class:"text-center"},{default:t(()=>[...e[31]||(e[31]=[n("비고",-1)])]),_:1})]),_:1})]),_:1}),l(ee,null,{default:t(()=>[(v(!0),q(T,null,M($.value,(o,z)=>(v(),Q(N,{key:o.eqm_id,onClick:ve=>P(o,z),class:de({"selected-row":C.value===z})},{default:t(()=>[l(b,{class:"text-center"},{default:t(()=>[n(k(z+1),1)]),_:2},1024),l(b,{class:"text-center"},{default:t(()=>[n(k(o.eqm_nm),1)]),_:2},1024),l(b,null,{default:t(()=>[n(k(o.make_model),1)]),_:2},1024),l(b,null,{default:t(()=>[n(k(R(o.make_dt)),1)]),_:2},1024),l(b,null,{default:t(()=>[n(k(R(o.setp_dt)),1)]),_:2},1024),l(b,{class:"text-center"},{default:t(()=>[n(k(o.st_nm||o.st||""),1)]),_:2},1024),l(b,null,{default:t(()=>[n(k(o.rm||""),1)]),_:2},1024)]),_:2},1032,["onClick","class"]))),128))]),_:1})]),_:1})],4)])]),_:1}),l(d,{md:6,class:"d-flex flex-column overflow-hidden right-pane"},{default:t(()=>[i("div",ie,[l(m,{color:"secondary",size:"sm",onClick:V},{default:t(()=>[...e[32]||(e[32]=[n("신규",-1)])]),_:1}),l(m,{color:"secondary",size:"sm",onClick:Y},{default:t(()=>[...e[33]||(e[33]=[n("저장",-1)])]),_:1}),l(m,{color:"danger",size:"sm",onClick:X,disabled:!c.value},{default:t(()=>[...e[34]||(e[34]=[n("삭제",-1)])]),_:1},8,["disabled"])]),i("div",ce,[i("div",ge,[l(f,{class:"mb-2"},{default:t(()=>[l(d,{md:3,class:"text-end pe-2"},{default:t(()=>[l(r,{class:"form-label pt-1"},{default:t(()=>[...e[35]||(e[35]=[n("설비 그룹 명",-1)])]),_:1})]),_:1}),l(d,{md:8,class:"ps-3"},{default:t(()=>[l(_,{modelValue:s.eqm_grp_nm,"onUpdate:modelValue":e[4]||(e[4]=o=>s.eqm_grp_nm=o),size:"sm",placeholder:"그룹명을 입력 또는 선택"},null,8,["modelValue"])]),_:1})]),_:1}),l(f,{class:"mb-2"},{default:t(()=>[l(d,{md:3,class:"text-end pe-2"},{default:t(()=>[l(r,{class:"form-label pt-1"},{default:t(()=>[...e[36]||(e[36]=[n("설비 명",-1)])]),_:1})]),_:1}),l(d,{md:8,class:"ps-3"},{default:t(()=>[l(_,{modelValue:s.eqm_nm,"onUpdate:modelValue":e[5]||(e[5]=o=>s.eqm_nm=o),size:"sm"},null,8,["modelValue"])]),_:1})]),_:1}),l(f,{class:"mb-2"},{default:t(()=>[l(d,{md:3,class:"text-end pe-2"},{default:t(()=>[l(r,{class:"form-label pt-1"},{default:t(()=>[...e[37]||(e[37]=[n("제조 모델",-1)])]),_:1})]),_:1}),l(d,{md:8,class:"ps-3"},{default:t(()=>[l(_,{modelValue:s.make_model,"onUpdate:modelValue":e[6]||(e[6]=o=>s.make_model=o),size:"sm",placeholder:"제조 모델을 입력하세요"},null,8,["modelValue"])]),_:1})]),_:1}),l(f,{class:"mb-2"},{default:t(()=>[l(d,{md:3,class:"text-end pe-2"},{default:t(()=>[l(r,{class:"form-label pt-1"},{default:t(()=>[...e[38]||(e[38]=[n("제조사",-1)])]),_:1})]),_:1}),l(d,{md:8,class:"ps-3"},{default:t(()=>[l(_,{modelValue:s.make_co,"onUpdate:modelValue":e[7]||(e[7]=o=>s.make_co=o),size:"sm",placeholder:"제조사를 입력하세요"},null,8,["modelValue"])]),_:1})]),_:1}),l(f,{class:"mb-2"},{default:t(()=>[l(d,{md:3,class:"text-end pe-2"},{default:t(()=>[l(r,{class:"form-label pt-1"},{default:t(()=>[...e[39]||(e[39]=[n("제조 일자",-1)])]),_:1})]),_:1}),l(d,{md:8,class:"ps-3"},{default:t(()=>[l(_,{type:"date",modelValue:s.make_dt,"onUpdate:modelValue":e[8]||(e[8]=o=>s.make_dt=o),size:"sm"},null,8,["modelValue"])]),_:1})]),_:1}),l(f,{class:"mb-2"},{default:t(()=>[l(d,{md:3,class:"text-end pe-2"},{default:t(()=>[l(r,{class:"form-label pt-1"},{default:t(()=>[...e[40]||(e[40]=[n("설치 일자",-1)])]),_:1})]),_:1}),l(d,{md:8,class:"ps-3"},{default:t(()=>[l(_,{type:"date",modelValue:s.setp_dt,"onUpdate:modelValue":e[9]||(e[9]=o=>s.setp_dt=o),size:"sm"},null,8,["modelValue"])]),_:1})]),_:1}),l(f,{class:"mb-2"},{default:t(()=>[l(d,{md:3,class:"text-end pe-2"},{default:t(()=>[l(r,{class:"form-label pt-1"},{default:t(()=>[...e[41]||(e[41]=[n("설비 상태",-1)])]),_:1})]),_:1}),l(d,{md:8,class:"ps-3"},{default:t(()=>[i("div",ke,[l(A,{class:"radio-item",type:"radio",id:"status-active",name:"status",value:"M2",modelValue:s.st,"onUpdate:modelValue":e[10]||(e[10]=o=>s.st=o),label:"가동"},null,8,["modelValue"]),l(A,{class:"radio-item",type:"radio",id:"status-inactive",name:"status",value:"M1",modelValue:s.st,"onUpdate:modelValue":e[11]||(e[11]=o=>s.st=o),label:"비가동"},null,8,["modelValue"])])]),_:1})]),_:1}),l(f,{class:"mb-2"}),l(f,{class:"mb-2"},{default:t(()=>[l(d,{md:3,class:"text-end pe-2"},{default:t(()=>[l(r,{class:"form-label pt-1"},{default:t(()=>[...e[42]||(e[42]=[n("점검 주기",-1)])]),_:1})]),_:1}),l(d,{md:8,class:"ps-3"},{default:t(()=>[l(_,{type:"text",modelValue:s.chck_cycle,"onUpdate:modelValue":e[12]||(e[12]=o=>s.chck_cycle=o),size:"sm",placeholder:"일 수"},null,8,["modelValue"])]),_:1})]),_:1}),l(f,{class:"mb-2"},{default:t(()=>[l(d,{md:3,class:"text-end pe-2"},{default:t(()=>[l(r,{class:"form-label pt-1"},{default:t(()=>[...e[43]||(e[43]=[n("비고",-1)])]),_:1})]),_:1}),l(d,{md:8,class:"ps-3"},{default:t(()=>[l(te,{modelValue:s.rm,"onUpdate:modelValue":e[13]||(e[13]=o=>s.rm=o),rows:"6",placeholder:"비고사항을 입력하세요",size:"sm"},null,8,["modelValue"])]),_:1})]),_:1})])])]),_:1})]),_:1})]),_:1})}}},Ce=se(ye,[["__scopeId","data-v-6ca7fa40"]]);export{Ce as default};
