import{r as x,s as D,e as c,c as F,a as _,w as r,d as i,g as C,f as e,j as h,H as R,B as T,v as H,b as v,x as K,F as A,h as E,t as u,m as I}from"./index-TO8iFplr.js";const L={class:"modal-body",style:{"max-height":"500px","overflow-y":"auto"}},U={class:"d-flex gap-2 mb-3 align-items-center flex-wrap"},j={class:"table table-bordered table-hover"},q=["onDblclick"],z={key:0},G={__name:"rscModal",props:{visible:Boolean},emits:["close","select"],setup(M,{emit:g}){const f=g,o=x("rsc_nm"),a=x(""),n=D([]),p=()=>{y(),f("close")},y=()=>{console.log("[rscModal] 검색 조건 초기화"),o.value="rsc_nm",a.value="",n.value=[]},b=async()=>{try{const s={rsc_id:"",rsc_clsf_id:"",rsc_nm:"",spec:"",unit:""};o.value==="rsc_id"?s.rsc_id=a.value||"":o.value==="rsc_clsf_id"?s.rsc_clsf_id=a.value||"":o.value==="rsc_nm"?s.rsc_nm=a.value||"":o.value==="spec"?s.spec=a.value||"":o.value==="unit"&&(s.unit=a.value||""),console.log("[rscModal] request params:",s);const d=(await I.get("/api/rscs",{params:s}).catch(m=>{throw m}))?.data;console.log("[rscModal] raw response:",d),Array.isArray(d)?n.value=d:(console.warn("[rscModal] unexpected response, expected array. set empty list."),n.value=[])}catch(s){console.error("[rscModal] rscSearch error",s),n.value=[]}},w=s=>{const l={rsc_id:s?.rsc_id??s?.RSC_ID??s?.rscId??"",rsc_clsf_id:s?.rsc_clsf_id??s?.rsc_ty??"",rsc_nm:s?.rsc_nm??s?.RSC_NM??s?.rscNm??"",spec:s?.spec??s?.SPEC??"",unit:s?.unit??s?.rsc_unit??"",rsc_ordr_deta_id:s?.rsc_ordr_deta_id??null};console.log("[rscModal] emit select payload:",l),f("select",l),p()};return(s,l)=>{const d=c("CModalTitle"),m=c("CModalHeader"),k=c("CModalBody"),B=c("CButton"),S=c("CModalFooter"),V=c("CModal");return _(),F(V,{visible:M.visible,onClose:p,size:"xl"},{default:r(()=>[i(m,null,{default:r(()=>[i(d,null,{default:r(()=>[...l[2]||(l[2]=[C("자재 검색",-1)])]),_:1})]),_:1}),i(k,null,{default:r(()=>[e("div",L,[e("div",U,[h(e("select",{class:"form-select",style:{width:"150px","flex-shrink":"0"},"onUpdate:modelValue":l[0]||(l[0]=t=>o.value=t)},[...l[3]||(l[3]=[e("option",{value:"rsc_id"},"자재 코드",-1),e("option",{value:"rsc_clsf_id"},"자재 분류",-1),e("option",{value:"rsc_nm"},"자재 명",-1),e("option",{value:"spec"},"규격",-1),e("option",{value:"unit"},"단위",-1)])],512),[[R,o.value]]),h(e("input",{type:"text",class:"form-control","onUpdate:modelValue":l[1]||(l[1]=t=>a.value=t),onKeyup:T(b,["enter"]),placeholder:"검색어 입력",style:{width:"300px","flex-shrink":"0"}},null,544),[[H,a.value]]),e("div",{class:"ms-auto d-flex gap-2"},[e("button",{class:"btn btn-secondary",onClick:b},"검색"),e("button",{class:"btn btn-secondary",onClick:y},"초기화")])]),e("table",j,[l[5]||(l[5]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"자재 코드"),e("th",null,"분류"),e("th",null,"명"),e("th",null,"규격"),e("th",null,"단위")])],-1)),e("tbody",null,[(_(!0),v(A,null,E(n.value,(t,N)=>(_(),v("tr",{key:t.rsc_id||N,onDblclick:P=>w(t)},[e("td",null,u(t.rsc_id),1),e("td",null,u(t.rsc_clsf_id||t.rsc_ty),1),e("td",null,u(t.rsc_nm),1),e("td",null,u(t.spec),1),e("td",null,u(t.rsc_unit||t.unit),1)],40,q))),128)),n.value.length===0?(_(),v("tr",z,[...l[4]||(l[4]=[e("td",{colspan:"5",class:"text-center text-muted"},"검색결과가 없습니다.",-1)])])):K("",!0)])])])]),_:1}),i(S,null,{default:r(()=>[i(B,{color:"secondary",onClick:p},{default:r(()=>[...l[6]||(l[6]=[C("닫기",-1)])]),_:1})]),_:1})]),_:1},8,["visible"])}}};export{G as _};
