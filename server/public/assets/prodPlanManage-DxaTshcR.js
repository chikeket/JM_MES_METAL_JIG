import{r as M,s as ee,e as i,c as N,a as v,w as t,d as l,g as p,f as n,j as E,b as $,x as le,H as te,v as Q,F as L,h as Z,u as z,t as f,m as O,i as ue,y as pe,q as ie,B as j}from"./index-TO8iFplr.js";import{u as G}from"./useDates-sS5pNIz9.js";const _e={class:"modal-body",style:{"max-height":"400px","overflow-y":"auto"}},ce={class:"mb-3"},me={class:"d-flex gap-2 align-items-center"},ve={class:"table table-bordered table-hover"},fe={class:"table table-bordered table-hover mb-0"},ye=["onDblclick"],ge={__name:"prodPlanRealModal",props:{visible:Boolean},emits:["close","select"],setup(J,{emit:A}){const S=A,I=()=>{o.value=[],y.value="",P.value="",C.value="",g.value="",S("close")},k=M("singleDate"),y=M(""),P=M(""),C=M(""),g=M("");let o=ee([]);const x=async()=>{const u={prod_plan_nm:"",reg_dt:"",prod_expc_fr_dt:"",prod_expc_to_dt:""};u.prod_plan_nm=y.value,k.value=="singleDate"?(P.value?u.reg_dt=P.value:u.reg_dt="1970-01-01",u.prod_expc_fr_dt="1970-01-01",u.prod_expc_to_dt="2125-01-01"):(u.reg_dt="1970-01-01",C.value!=null&&!g.value?(u.prod_expc_fr_dt=C.value,u.prod_expc_to_dt="2125-01-01"):!C.value&&g.value!=null?(u.prod_expc_fr_dt="1970-01-01",u.prod_expc_to_dt=g.value):(u.prod_expc_fr_dt=C.value,u.prod_expc_to_dt=g.value)),console.log(u);let d=await O.get("/api/prodPlanRealMasterSearch",{params:u}).catch(V=>console.log(V));console.log(d.data),o.value=d.data},_=async u=>{console.log(u);const d={prod_plan_id:""};d.prod_plan_id=u.prod_plan_id;let V=await O.get("/api/prodPlanRealDetaSearch",{params:d}).catch(w=>console.log(w));S("select",{detailData:V.data,searchParams:{emp_id:u.emp_id,prod_expc_fr_dt:G.dateFormat(u.prod_expc_fr_dt,"yyyy-MM-dd"),prod_expc_to_dt:G.dateFormat(u.prod_expc_to_dt,"yyyy-MM-dd"),prod_plan_id:u.prod_plan_id,prod_plan_nm:u.prod_plan_nm,rcvord_id:u.rcvord_id,reg_dt:G.dateFormat(u.reg_dt,"yyyy-MM-dd"),rm:u.rm}}),I()};return(u,d)=>{const V=i("CModalTitle"),w=i("CModalHeader"),T=i("CInputGroupText"),D=i("CFormInput"),H=i("CInputGroup"),m=i("CModalBody"),B=i("CButton"),K=i("CModalFooter"),W=i("CModal");return v(),N(W,{visible:J.visible,onClose:I,size:"xl"},{default:t(()=>[l(w,null,{default:t(()=>[l(V,null,{default:t(()=>[...d[6]||(d[6]=[p("생산계획조회",-1)])]),_:1})]),_:1}),l(m,null,{default:t(()=>[n("div",_e,[n("div",ce,[l(H,{class:"mb-2"},{default:t(()=>[l(T,{id:"addon-ordr-name-1"},{default:t(()=>[...d[7]||(d[7]=[p("생산계획명",-1)])]),_:1}),l(D,{modelValue:y.value,"onUpdate:modelValue":d[0]||(d[0]=a=>y.value=a),placeholder:"생산계획명"},null,8,["modelValue"])]),_:1}),n("div",me,[E(n("select",{class:"form-select",style:{width:"200px"},"onUpdate:modelValue":d[1]||(d[1]=a=>k.value=a)},[...d[8]||(d[8]=[n("option",{value:"singleDate"},"생산계획등록일",-1),n("option",{value:"prod_expc_dt"},"생산계획일정조회",-1)])],512),[[te,k.value]]),k.value=="singleDate"?E((v(),$("input",{key:0,type:"date",class:"form-control","onUpdate:modelValue":d[2]||(d[2]=a=>P.value=a)},null,512)),[[Q,P.value]]):k.value=="prod_expc_dt"?(v(),$(L,{key:1},[E(n("input",{type:"date",class:"form-control","onUpdate:modelValue":d[3]||(d[3]=a=>C.value=a)},null,512),[[Q,C.value]]),d[9]||(d[9]=n("span",null,"~",-1)),E(n("input",{type:"date",class:"form-control","onUpdate:modelValue":d[4]||(d[4]=a=>g.value=a)},null,512),[[Q,g.value]])],64)):le("",!0),n("button",{class:"btn btn-secondary",onClick:d[5]||(d[5]=a=>x()),style:{width:"70px"}}," 검색 ")])]),n("table",ve,[d[10]||(d[10]=n("thead",{class:"table-light"},[n("tr",null,[n("th",null,"생산계획명"),n("th",null,"생산계획시작일"),n("th",null,"생산계획종료일"),n("th",null,"등록일")])],-1)),n("tbody",fe,[(v(!0),$(L,null,Z(z(o),(a,e)=>(v(),$("tr",{key:e,onDblclick:r=>_(a)},[n("td",null,f(a.prod_plan_nm),1),n("td",null,f(z(G).dateFormat(a.prod_expc_fr_dt,"yyyy-MM-dd")),1),n("td",null,f(z(G).dateFormat(a.prod_expc_to_dt,"yyyy-MM-dd")),1),n("td",null,f(z(G).dateFormat(a.reg_dt,"yyyy-MM-dd")),1)],40,ye))),128))])])])]),_:1}),l(K,null,{default:t(()=>[l(B,{color:"secondary",onClick:I},{default:t(()=>[...d[11]||(d[11]=[p("닫기",-1)])]),_:1})]),_:1})]),_:1},8,["visible"])}}},be={class:"modal-body",style:{"max-height":"400px","overflow-y":"auto"}},Ce={class:"d-flex gap-2 mb-3"},xe={class:"d-flex gap-2 mb-3"},De={class:"table table-bordered table-hover"},Me={class:"table table-bordered table-hover mb-0"},ke=["onDblclick"],Pe={__name:"rcvordMykModal",props:{visible:Boolean},emits:["close","select"],setup(J,{emit:A}){const S=A,I=()=>{C.value=[],S("close")},k=M("co_nm"),y=M(""),P=M("");let C=ee([]);const g=async()=>{const x={rcvord_id:"",co_nm:"",emp_nm:"",reg_dt:""};k.value=="rcvord_id"?x.rcvord_id=y.value:k.value=="co_nm"?x.co_nm=y.value:x.emp_nm=y.value,x.reg_dt=P.value?P.value:"1970-01-01";let _=await O.get("/api/prodPlanRcvordMasterSearch",{params:x}).catch(u=>console.log(u));console.log(_.data),C.value=_.data},o=async x=>{const _={rcvord_id:""};_.rcvord_id=x.rcvord_id;let u=await O.get("/api/prodPlanRcvordDetaSearch",{params:_}).catch(d=>console.log(d));console.log(u.data),S("select",{detailData:u.data,searchParams:x}),I()};return(x,_)=>{const u=i("CModalTitle"),d=i("CModalHeader"),V=i("CInputGroupText"),w=i("CModalBody"),T=i("CButton"),D=i("CModalFooter"),H=i("CModal");return v(),N(H,{visible:J.visible,onClose:I},{default:t(()=>[l(d,null,{default:t(()=>[l(u,null,{default:t(()=>[..._[4]||(_[4]=[p("제품 검색",-1)])]),_:1})]),_:1}),l(w,null,{default:t(()=>[n("div",be,[n("div",Ce,[E(n("select",{class:"form-select",style:{width:"150px"},"onUpdate:modelValue":_[0]||(_[0]=m=>k.value=m)},[..._[5]||(_[5]=[n("option",{value:"rcvord_id"},"코드",-1),n("option",{value:"co_nm"},"납품업체",-1),n("option",{value:"emp_nm"},"수주담당자",-1)])],512),[[te,k.value]]),E(n("input",{type:"text",class:"form-control",placeholder:"검색어 입력","onUpdate:modelValue":_[1]||(_[1]=m=>y.value=m)},null,512),[[Q,y.value]])]),n("div",xe,[l(V,{id:"addon-ordr-name-2"},{default:t(()=>[..._[6]||(_[6]=[p("수주 일자",-1)])]),_:1}),E(n("input",{type:"date",class:"form-control","onUpdate:modelValue":_[2]||(_[2]=m=>P.value=m)},null,512),[[Q,P.value]]),n("button",{class:"btn btn-secondary",style:{width:"90px"},onClick:_[3]||(_[3]=m=>g())},"검색")]),n("table",De,[_[7]||(_[7]=n("thead",{class:"table-light"},[n("tr",null,[n("th",null,"코드"),n("th",null,"납품업체"),n("th",null,"수주담당자"),n("th",null,"등록일자")])],-1)),n("tbody",Me,[(v(!0),$(L,null,Z(z(C),(m,B)=>(v(),$("tr",{key:B,onDblclick:K=>o(m)},[n("td",null,f(m.rcvord_id),1),n("td",null,f(m.co_nm),1),n("td",null,f(m.emp_nm),1),n("td",null,f(z(G).dateFormat(m.reg_dt,"yyyy-MM-dd")),1)],40,ke))),128))])])])]),_:1}),l(D,null,{default:t(()=>[l(T,{color:"secondary",onClick:I},{default:t(()=>[..._[8]||(_[8]=[p("닫기",-1)])]),_:1})]),_:1})]),_:1},8,["visible"])}}},Ve={class:"d-flex justify-content-end gap-2 mb-3"},Te={class:"d-flex justify-content-end gap-2 mb-3"},Se={__name:"prodPlanManage",setup(J){const A=ue(),S=M(!1),I=()=>{S.value=!0},k=()=>{S.value=!1},y=M(!1),P=()=>{y.value=!0},C=()=>{y.value=!1};let g=A.user?.emp_id||"EMP001";const o=M({ordrName1:"",prod_plan_id:"",rcvord_id:"",regDate:new Date().toISOString().slice(0,10),startDate:new Date().toISOString().slice(0,10),endDate:null,remark:""}),x=async()=>{if(o.value.endDate==null)return alert("종료일을 지정해주세요");const a={rm:o.value.remark,rcvord_id:o.value.rcvord_id,emp_id:g,prod_plan_nm:o.value.ordrName1,prod_expc_fr_dt:o.value.startDate,prod_expc_to_dt:o.value.endDate,reg_dt:o.value.regDate},e=d.value.map(c=>({rm:c.rm,prdt_id:c.prdt_id,prdt_opt_id:c.prdt_opt_id,plan_qy:c.plan_qy,priort:c.priort})),r={masterInfo:a,detailList:e};console.log(r),(await O.post("/api/insertProdPlanManage",r).catch(c=>console.log(c))).data.isSuccessed?console.log("생산계획이 등록되었습니다."):console.log("생산계획이 실패했습니다.")},_=async()=>{console.log(o.value),console.log(d.value);const a={rm:o.value.remark,rcvord_id:o.value.rcvord_id,emp_id:g,prod_plan_nm:o.value.ordrName1,prod_expc_fr_dt:o.value.startDate,prod_expc_to_dt:o.value.endDate,reg_dt:o.value.regDate,prod_plan_id:o.value.prod_plan_id},e=d.value.map(c=>({rm:c.rm,prdt_id:c.prdt_id,prdt_opt_id:c.prdt_opt_id,plan_qy:c.plan_qy,priort:c.priort,prod_plan_id:c.prod_plan_id,prod_plan_deta_id:c.prod_plan_deta_id})),r={masterInfo:a,detailList:e};console.log(r),(await O.post("/api/updateProdPlanManage",r).catch(c=>console.log(c))).data.isSuccessed?console.log("생산계획수정이 등록되었습니다."):console.log("생산계획수정이 실패했습니다.")},u=async()=>{const a={prod_plan_id:o.value.prod_plan_id};(await O.post("/api/deleteProdPlanManage",a).catch(U=>console.log(U))).data.isSuccessed?console.log("생산계획삭제가 성공되었습니다."):console.log("생산계획삭제가 실패했습니다. Info.value.prod_plan_id")},d=M([]),V=a=>{console.log(a),o.value.prod_plan_id=a.searchParams.prod_plan_id?a.searchParams.prod_plan_id:o.value.prod_plan_id,o.value.rcvord_id=a.searchParams.rcvord_id?a.searchParams.rcvord_id:o.value.rcvord_id,o.value.ordrName1=a.searchParams.prod_plan_nm?a.searchParams.prod_plan_nm:o.value.ordrName1,g=a.searchParams.emp_id?a.searchParams.emp_id:g,o.value.startDate=a.searchParams.prod_expc_fr_dt?a.searchParams.prod_expc_fr_dt:o.value.startDate,o.value.endDate=a.searchParams.prod_expc_to_dt?a.searchParams.prod_expc_to_dt:o.value.endDate,o.value.regDate=a.searchParams.reg_dt?a.searchParams.reg_dt:o.value.regDate,o.value.remark=a.searchParams.rm?a.searchParams.rm:o.value.remark;let e=d.value.length>0?Math.max(...d.value.map(r=>r.id??0))+1:1;d.value=[];for(const r of a.detailData)d.value.push({id:e++,prod_plan_deta_id:r.prod_plan_deta_id,prod_plan_id:r.prod_plan_id,prdt_id:r.prdt_id,prdt_nm:r.prdt_nm,prdt_opt_id:r.prdt_opt_id,opt_nm:r.opt_nm,spec:r.spec,unit:r.unit,plan_qy:r.plan_qy?r.plan_qy:0,paprd_dt:r.paprd_dt,priort:r.priort,rm:r.rm})},w=()=>{o.value.ordrName1="",o.value.startDate=new Date().toISOString().slice(0,10),o.value.endDate=null,o.value.regDate=new Date().toISOString().slice(0,10),o.value.remark="",d.value=[]},T=pe({id:null,field:null}),D=M(null),H=(a,e)=>T.id===a.id&&T.field===e;function m(a,e){T.id=a.id,T.field=e;const r=a[e];D.value=e==="producible"?String(!!r):r}function B(a,e){let r=D.value;e==="drct_qy"||(e==="producible"?a.producible=r==="true"||r===!0:e==="unit"?a.unit=String(r||"EA"):a[e]=(r??"").toString()),K()}function K(){T.id=null,T.field=null,D.value=null}ie(()=>o.value.endDate,a=>{o.value.endDate<o.value.startDate?alert("종료일은 시작일과 같거나 이후여야 합니다"):o.value.endDate=a});const W=a=>(a??0).toLocaleString();return(a,e)=>{const r=i("CButton"),U=i("CInputGroupText"),F=i("CFormInput"),c=i("CInputGroup"),X=i("CCol"),oe=i("CRow"),h=i("CContainer"),ae=i("CFormTextarea"),q=i("CTableHeaderCell"),Y=i("CTableRow"),de=i("CTableHead"),R=i("CTableDataCell"),ne=i("CTableBody"),re=i("CTable");return v(),N(h,{fluid:""},{default:t(()=>[n("div",Ve,[l(r,{color:"secondary",onClick:e[0]||(e[0]=s=>w())},{default:t(()=>[...e[12]||(e[12]=[p("신규",-1)])]),_:1}),l(r,{color:"secondary",onClick:e[1]||(e[1]=s=>I())},{default:t(()=>[...e[13]||(e[13]=[p("생산계획서 조회",-1)])]),_:1}),l(ge,{visible:S.value,onClose:k,onSelect:V},null,8,["visible"]),l(r,{color:"secondary",onClick:x},{default:t(()=>[...e[14]||(e[14]=[p("저장",-1)])]),_:1}),l(r,{color:"secondary",onClick:_},{default:t(()=>[...e[15]||(e[15]=[p("수정",-1)])]),_:1}),l(r,{color:"danger",onClick:e[2]||(e[2]=s=>u())},{default:t(()=>[...e[16]||(e[16]=[p("삭제",-1)])]),_:1})]),l(h,{fluid:""},{default:t(()=>[l(oe,{class:"g-3 mb-3"},{default:t(()=>[l(X,{md:"3"},{default:t(()=>[l(c,null,{default:t(()=>[l(U,{id:"addon-ordr-name-1"},{default:t(()=>[...e[17]||(e[17]=[p("생산계획서 명",-1)])]),_:1}),l(F,{modelValue:o.value.ordrName1,"onUpdate:modelValue":e[3]||(e[3]=s=>o.value.ordrName1=s),placeholder:"생산지시서 명"},null,8,["modelValue"])]),_:1})]),_:1}),l(X,{md:"3"},{default:t(()=>[l(c,null,{default:t(()=>[l(U,{id:"addon-ordr-name-2"},{default:t(()=>[...e[18]||(e[18]=[p("등록 일자",-1)])]),_:1}),l(F,{type:"date",modelValue:o.value.regDate,"onUpdate:modelValue":e[4]||(e[4]=s=>o.value.regDate=s)},null,8,["modelValue"])]),_:1})]),_:1}),l(X,{md:"3"},{default:t(()=>[l(c,null,{default:t(()=>[l(U,{id:"addon-ordr-name-2"},{default:t(()=>[...e[19]||(e[19]=[p("시작 일자",-1)])]),_:1}),l(F,{type:"date",modelValue:o.value.startDate,"onUpdate:modelValue":e[5]||(e[5]=s=>o.value.startDate=s)},null,8,["modelValue"])]),_:1})]),_:1}),l(X,{md:"3"},{default:t(()=>[l(c,null,{default:t(()=>[l(U,{id:"addon-ordr-name-2"},{default:t(()=>[...e[20]||(e[20]=[p("종료 일자",-1)])]),_:1}),l(F,{type:"date",modelValue:o.value.endDate,"onUpdate:modelValue":e[6]||(e[6]=s=>o.value.endDate=s)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(ae,{modelValue:o.value.remark,"onUpdate:modelValue":e[7]||(e[7]=s=>o.value.remark=s),label:"비고",rows:"3",text:"필요 시 기재"},null,8,["modelValue"]),n("div",Te,[l(r,{color:"secondary",onClick:e[8]||(e[8]=s=>P())},{default:t(()=>[...e[21]||(e[21]=[p("수주서 조회",-1)])]),_:1}),l(Pe,{visible:y.value,onClose:C,onSelect:V},null,8,["visible"])]),l(re,{hover:"",bordered:"",small:"",class:"align-middle"},{default:t(()=>[l(de,{color:"dark"},{default:t(()=>[l(Y,null,{default:t(()=>[l(q,{scope:"col",class:"text-center",style:{width:"160px"}},{default:t(()=>[...e[22]||(e[22]=[p("코드",-1)])]),_:1}),l(q,{scope:"col",class:"text-center"},{default:t(()=>[...e[23]||(e[23]=[p("제품명",-1)])]),_:1}),l(q,{scope:"col",class:"text-center",style:{width:"100px"}},{default:t(()=>[...e[24]||(e[24]=[p("규격",-1)])]),_:1}),l(q,{scope:"col",class:"text-center",style:{width:"60px"}},{default:t(()=>[...e[25]||(e[25]=[p("단위",-1)])]),_:1}),l(q,{scope:"col",class:"text-center",style:{width:"140px"}},{default:t(()=>[...e[26]||(e[26]=[p("납품일",-1)])]),_:1}),l(q,{scope:"col",class:"text-center",style:{width:"120px"}},{default:t(()=>[...e[27]||(e[27]=[p("계획수량",-1)])]),_:1}),l(q,{scope:"col",class:"text-center"},{default:t(()=>[...e[28]||(e[28]=[p("우선순위",-1)])]),_:1}),l(q,{scope:"col",class:"text-center"},{default:t(()=>[...e[29]||(e[29]=[p("비고",-1)])]),_:1})]),_:1})]),_:1}),l(ne,null,{default:t(()=>[(v(!0),$(L,null,Z(d.value,(s,se)=>(v(),N(Y,{key:s.id??se},{default:t(()=>[l(R,{scope:"row"},{default:t(()=>[p(f(s.prdt_id+" - "+s.prdt_opt_id),1)]),_:2},1024),l(R,{scope:"row"},{default:t(()=>[p(f(s.prdt_nm+" - "+s.opt_nm),1)]),_:2},1024),l(R,{scope:"row"},{default:t(()=>[p(f(s.spec),1)]),_:2},1024),l(R,{scope:"row"},{default:t(()=>[p(f(s.unit),1)]),_:2},1024),l(R,{scope:"row"},{default:t(()=>[p(f(z(G).dateFormat(s.paprd_dt,"yyyy-MM-dd")),1)]),_:2},1024),l(R,{class:"text-end",onDblclick:b=>m(s,"plan_qy")},{default:t(()=>[H(s,"plan_qy")?(v(),N(F,{key:0,modelValue:D.value,"onUpdate:modelValue":e[9]||(e[9]=b=>D.value=b),modelModifiers:{number:!0},type:"number",min:"0",size:"sm",class:"text-end",onKeyup:[j(b=>B(s,"plan_qy"),["enter"]),j(K,["esc"])],onBlur:b=>B(s,"plan_qy"),placeholder:"0"},null,8,["modelValue","onKeyup","onBlur"])):(v(),$(L,{key:1},[p(f(W(s.plan_qy)),1)],64))]),_:2},1032,["onDblclick"]),l(R,{class:"text-end",onDblclick:b=>m(s,"priort")},{default:t(()=>[H(s,"priort")?(v(),N(F,{key:0,modelValue:D.value,"onUpdate:modelValue":e[10]||(e[10]=b=>D.value=b),modelModifiers:{number:!0},type:"number",min:"0",size:"sm",class:"text-end",onKeyup:[j(b=>B(s,"priort"),["enter"]),j(K,["esc"])],onBlur:b=>B(s,"priort"),placeholder:"0"},null,8,["modelValue","onKeyup","onBlur"])):(v(),$(L,{key:1},[p(f(W(s.priort)),1)],64))]),_:2},1032,["onDblclick"]),l(R,{onDblclick:b=>m(s,"rm")},{default:t(()=>[H(s,"rm")?(v(),N(F,{key:0,modelValue:D.value,"onUpdate:modelValue":e[11]||(e[11]=b=>D.value=b),size:"sm",onKeyup:[j(b=>B(s,"rm"),["enter"]),j(K,["esc"])],onBlur:b=>B(s,"rm")},null,8,["modelValue","onKeyup","onBlur"])):(v(),$(L,{key:1},[p(f(s.rm||"—"),1)],64))]),_:2},1032,["onDblclick"])]),_:2},1024))),128)),!d.value||d.value.length===0?(v(),N(Y,{key:0},{default:t(()=>[l(R,{colspan:"10",class:"text-center text-muted py-5"},{default:t(()=>[...e[30]||(e[30]=[p("행이 없습니다.",-1)])]),_:1})]),_:1})):le("",!0)]),_:1})]),_:1})]),_:1})}}};export{Se as default};
