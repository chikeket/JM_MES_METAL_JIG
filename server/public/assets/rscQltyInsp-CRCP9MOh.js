import{r as g,s as h,q as A,e as c,c as H,a as q,w as t,d as l,g as _,f as s,j as T,x as J,H as ee,b as $,v as P,F as K,h as W,u as a,t as C,m as B,_ as le,i as te,z as X,L as S,X as Q,U as V,W as j,$ as oe,M as ae,N as E,O as L,Q as se,K as G,R as ne}from"./index-TO8iFplr.js";import{u as z}from"./useDates-sS5pNIz9.js";const ue={class:"modal-body",style:{"max-height":"400px","overflow-y":"auto"}},de={class:"mb-3"},re={class:"d-flex gap-2 mb-3"},ie={class:"table table-bordered table-hover"},_e={class:"table table-bordered table-hover mb-0"},me=["onDblclick"],pe={__name:"waitingRscQltyInspModal",props:{visible:Boolean},emits:["close","select"],setup(O,{emit:F}){const k=F,w=()=>{b.value="",x.value="",U.value="",o.value="",p.value="",y.value="rsc_nm",i.value=[],k("close")},y=g("rsc_nm"),b=g(""),x=g(""),U=g(""),o=g(""),p=g("");let i=h([]);A(y,v=>{v!=="rsc_nm"&&(b.value=""),v!=="qy"&&(x.value=""),v!=="emp_nm"&&(U.value=""),v!=="co_nm"&&(o.value="")});const M=async()=>{const v={rsc_nm:b.value||"",qy:x.value||"",emp_nm:U.value||"",co_nm:o.value||"",reg_dt:p.value||""};console.log(v);let r=await B.get("/api/rscOrdrQltyList",{params:v}).catch(I=>console.log(I));console.log(r.data),i.value=r.data},N=async v=>{const r={rsc_id:""};r.rsc_id=v.rsc_id;let I=await B.get("/api/rscQltyDeta",{params:r}).catch(D=>console.log(D));console.log(I.data),k("select",{detailData:I.data,searchParams:v}),w()};return(v,r)=>{const I=c("CModalTitle"),D=c("CModalHeader"),R=c("CModalBody"),u=c("CButton"),e=c("CModalFooter"),d=c("CModal");return q(),H(d,{visible:O.visible,onClose:w,size:"xl"},{default:t(()=>[l(D,null,{default:t(()=>[l(I,null,{default:t(()=>[...r[7]||(r[7]=[_("자재발주서 검색",-1)])]),_:1})]),_:1}),l(R,null,{default:t(()=>[s("div",ue,[s("div",de,[s("div",re,[T(s("select",{class:"form-select",style:{width:"150px"},"onUpdate:modelValue":r[0]||(r[0]=n=>y.value=n)},[...r[8]||(r[8]=[s("option",{value:"rsc_nm"},"자재명",-1),s("option",{value:"qy"},"자재수량",-1),s("option",{value:"emp_nm"},"발주자명",-1),s("option",{value:"co_nm"},"발주처",-1)])],512),[[ee,y.value]]),y.value=="rsc_nm"?T((q(),$("input",{key:0,type:"text",class:"form-control","onUpdate:modelValue":r[1]||(r[1]=n=>b.value=n)},null,512)),[[P,b.value]]):y.value=="qy"?T((q(),$("input",{key:1,type:"text",class:"form-control","onUpdate:modelValue":r[2]||(r[2]=n=>x.value=n)},null,512)),[[P,x.value]]):y.value=="emp_nm"?T((q(),$("input",{key:2,type:"text",class:"form-control","onUpdate:modelValue":r[3]||(r[3]=n=>U.value=n)},null,512)),[[P,U.value]]):y.value=="co_nm"?T((q(),$("input",{key:3,type:"text",class:"form-control","onUpdate:modelValue":r[4]||(r[4]=n=>o.value=n)},null,512)),[[P,o.value]]):J("",!0),s("button",{class:"btn btn-secondary",onClick:r[5]||(r[5]=n=>M())},"검색")]),T(s("input",{type:"text",class:"form-control","onUpdate:modelValue":r[6]||(r[6]=n=>p.value=n),placeholder:"발주등록일",onfocus:"(this.type='date')",onblur:"if(!this.value)this.type='text'"},null,512),[[P,p.value]])]),s("table",ie,[r[9]||(r[9]=s("thead",{class:"table-light"},[s("tr",null,[s("th",null,"자재명"),s("th",null,"자재수량"),s("th",null,"발주자명"),s("th",null,"발주처"),s("th",null,"발주날짜")])],-1)),s("tbody",_e,[(q(!0),$(K,null,W(a(i),(n,f)=>(q(),$("tr",{key:f,onDblclick:m=>N(n)},[s("td",null,C(n.rsc_nm),1),s("td",null,C(Math.floor(n.qy)),1),s("td",null,C(n.emp_nm),1),s("td",null,C(n.co_nm),1),s("td",null,C(a(z).dateFormat(n.reg_dt,"yyyy-MM-dd")),1)],40,me))),128))])])])]),_:1}),l(e,null,{default:t(()=>[l(u,{color:"secondary",onClick:w},{default:t(()=>[...r[10]||(r[10]=[_("닫기",-1)])]),_:1})]),_:1})]),_:1},8,["visible"])}}},ce={class:"modal-body",style:{"max-height":"400px","overflow-y":"auto"}},ve={class:"mb-3"},ye={class:"d-flex gap-2 mb-3"},fe={class:"d-flex gap-2 mb-3"},be={class:"table table-bordered table-hover"},qe={class:"table table-bordered table-hover mb-0"},ge=["onDblclick"],Ce={__name:"rscQltyInspModal",props:{visible:Boolean},emits:["close","select"],setup(O,{emit:F}){const k=F,w=()=>{y.value="",b.value="",x.value=[],k("close")},y=g(""),b=g("");let x=h([]);const U=async()=>{const p={emp_nm:y.value||"",insp_dt:b.value||"1970-01-01"};console.log(p);let i=await B.get("/api/rscQltyInspSelect",{params:p}).catch(M=>console.log(M));console.log(i.data),x.value=i.data},o=async p=>{const i={rsc_qlty_insp_id:""};i.rsc_qlty_insp_id=p.rsc_qlty_insp_id;let M=await B.get("/api/rscQltyInspInferSelect",{params:i}).catch(N=>console.log(N));console.log(M.data),k("select",{detailData:M.data,searchParams:p}),w()};return(p,i)=>{const M=c("CModalTitle"),N=c("CModalHeader"),v=c("CInputGroupText"),r=c("CFormInput"),I=c("CInputGroup"),D=c("CModalBody"),R=c("CButton"),u=c("CModalFooter"),e=c("CModal");return q(),H(e,{visible:O.visible,onClose:w,size:"xl"},{default:t(()=>[l(N,null,{default:t(()=>[l(M,null,{default:t(()=>[...i[3]||(i[3]=[_("자재품질 검수서 검색",-1)])]),_:1})]),_:1}),l(D,null,{default:t(()=>[s("div",ce,[s("div",ve,[s("div",ye,[l(I,{class:"mb-2"},{default:t(()=>[l(v,{id:"addon-ordr-name-1"},{default:t(()=>[...i[4]||(i[4]=[_("검수자",-1)])]),_:1}),l(r,{modelValue:y.value,"onUpdate:modelValue":i[0]||(i[0]=d=>y.value=d),placeholder:"검수자이름"},null,8,["modelValue"])]),_:1})]),s("div",fe,[l(v,{id:"addon-ordr-name-2"},{default:t(()=>[...i[5]||(i[5]=[_("검수 일자",-1)])]),_:1}),T(s("input",{type:"date",class:"form-control","onUpdate:modelValue":i[1]||(i[1]=d=>b.value=d)},null,512),[[P,b.value]]),s("button",{class:"btn btn-secondary",style:{width:"70px"},onClick:i[2]||(i[2]=d=>U())}," 검색 ")])]),s("table",be,[i[6]||(i[6]=s("thead",{class:"table-light"},[s("tr",null,[s("th",null,"검수자"),s("th",null,"자재명"),s("th",null,"검수 수량"),s("th",null,"합격 수량"),s("th",null,"검수 일자")])],-1)),s("tbody",qe,[(q(!0),$(K,null,W(a(x),(d,n)=>(q(),$("tr",{key:n,onDblclick:f=>o(d)},[s("td",null,C(d.emp_nm),1),s("td",null,C(d.rsc_nm),1),s("td",null,C(Math.floor(d.insp_qy)),1),s("td",null,C(Math.floor(d.pass_qy)),1),s("td",null,C(a(z).dateFormat(d.reg_dt,"yyyy-MM-dd")),1)],40,ge))),128))])])])]),_:1}),l(u,null,{default:t(()=>[l(R,{color:"secondary",onClick:w},{default:t(()=>[...i[7]||(i[7]=[_("닫기",-1)])]),_:1})]),_:1})]),_:1},8,["visible"])}}},Me={class:"d-flex justify-content-end gap-2 mb-3"},xe={__name:"rscQltyInsp",setup(O){const F=te(),k=g(!1),w=()=>{k.value=!0},y=()=>{k.value=!1},b=g(!1),x=()=>{b.value=!0},U=()=>{b.value=!1},o=g({emp_id:F.user?.emp_id||"EMP001",emp_nm:F.user?.emp_nm||"홍길동",co_nm:"",rcs_nm:"",qy:"",receivedQty:"",receivedQty_base:"",insp_qy:"",insp_qy_base:"",insp_dt:z.dateFormat(new Date,"yyyy-MM-dd"),note:"",rsc_ordr_deta_id:"",rsc_qlty_insp_id:""}),p=g([]),i=X(()=>{const u=Number(o.value.insp_qy)||0,e=Number(N.value)||0;return u-e}),M=X(()=>{const u=Number(o.value.qy)||0,e=Number(o.value.receivedQty)||0;return u-e}),N=g(0);A(p,u=>{let e=0;for(const d of u){const n=Number(d.infer_qy);isNaN(n)||(e+=n)}N.value=e},{deep:!0}),A(()=>o.value.insp_qy,u=>{const e=Number(o.value.qy)||0,d=Number(u);if(isNaN(d)||d<0){alert("검수 수량은 0 이상의 숫자만 입력 가능합니다."),o.value.pass_qy=0;return}d>e&&(alert("검수 수량이 발주 수량보다 많을 수 없습니다."),o.value.pass_qy=0),o.value.receivedQty=Number(o.value.receivedQty_base)+Number(o.value.insp_qy)-Number(o.value.insp_qy_base)});const v=u=>{p.value=[],o.value.co_nm=u.searchParams.co_nm,o.value.qy=Math.floor(u.searchParams.qy),o.value.insp_qy=Math.floor(u.searchParams.insp_qy)||0,o.value.insp_qy_base=Math.floor(u.searchParams.insp_qy)||0,o.value.receivedQty=Math.floor(u.searchParams.qy)-Math.floor(u.searchParams.rtngud_qy)||0,o.value.receivedQty_base=Math.floor(u.searchParams.qy)-Math.floor(u.searchParams.rtngud_qy)||0,o.value.rcs_nm=u.searchParams.rsc_nm,o.value.rsc_ordr_deta_id=u.searchParams.rsc_ordr_deta_id,o.value.rsc_qlty_insp_id=u.searchParams.rsc_qlty_insp_id;for(const e of u.detailData)p.value.push({insp_item_nm:e.insp_item_nm,basi_val:e.basi_val,eror_scope_min:e.eror_scope_min,eror_scope_max:e.eror_scope_max,infer_qy:e.infer_qy||0,qlty_item_mng_id:e.qlty_item_mng_id,rsc_qlty_insp_id:e.rsc_qlty_insp_id});console.log(u)},r=async()=>{let u=[];for(const f of p.value)u.push({infer_qy:f.infer_qy,qlty_item_mng_id:f.qlty_item_mng_id});const e={master:{rm:o.value.note,rsc_ordr_deta_id:o.value.rsc_ordr_deta_id,emp_id:o.value.emp_id,rtngud_qy:M.value,pass_qy:i.value,insp_qy:o.value.insp_qy,insp_dt:o.value.insp_dt},infer:u};console.log(e),(await B.post("/api/rscQltyInspInsert",e).catch(f=>console.log(f))).data.isSuccessed?console.log("자재품질검수가 등록되었습니다."):console.log("자재품질검수에 실패했습니다.")},I=async()=>{let u=[];for(const f of p.value)u.push({infer_qy:f.infer_qy,qlty_item_mng_id:f.qlty_item_mng_id,rsc_qlty_insp_id:f.rsc_qlty_insp_id});const e={master:{rm:o.value.note,rsc_ordr_deta_id:o.value.rsc_ordr_deta_id,emp_id:o.value.emp_id,rtngud_qy:M.value,pass_qy:i.value,insp_qy:o.value.insp_qy,insp_dt:o.value.insp_dt,rsc_qlty_insp_id:o.value.rsc_qlty_insp_id},infer:u};(await B.post("/api/rscQltyInspUpdate",e).catch(f=>console.log(f))).data.isSuccessed?console.log("자재품질검수 수정이 등록되었습니다."):console.log("자재품질검수 수정에 실패했습니다.")},D=async()=>{const u={rsc_qlty_insp_id:o.value.rsc_qlty_insp_id};(await B.post("/api/rscQltyInspDelete",u).catch(n=>console.log(n))).data.isSuccessed?console.log("자재품질검수 삭제가 성공되었습니다."):console.log("자재품질검수 삭제가 실패했습니다.")},R=async()=>{o.value.insp_dt=z.dateFormat(new Date,"yyyy-MM-dd"),o.value.insp_qy=0,o.value.insp_qy_base=0,o.value.note="",o.value.pass_qy=0,o.value.qy=0,o.value.rcs_nm="",o.value.receivedQty=0,o.value.receivedQty_base=0,o.value.rsc_ordr_deta_id="",o.value.rsc_qlty_insp_id="",p.value=[]};return(u,e)=>{const d=c("CInputGroupText"),n=c("CInputGroup"),f=c("CContainer");return q(),H(f,{fluid:""},{default:t(()=>[s("div",Me,[l(a(S),{color:"secondary",onClick:e[0]||(e[0]=m=>R())},{default:t(()=>[...e[13]||(e[13]=[_("신규",-1)])]),_:1}),l(a(S),{color:"secondary",onClick:e[1]||(e[1]=m=>x())},{default:t(()=>[...e[14]||(e[14]=[_("자재품질 조회",-1)])]),_:1}),l(Ce,{visible:b.value,onClose:U,onSelect:v},null,8,["visible"]),l(pe,{visible:k.value,onClose:y,onSelect:v},null,8,["visible"]),l(a(S),{color:"secondary",onClick:e[2]||(e[2]=m=>r())},{default:t(()=>[...e[15]||(e[15]=[_("저장",-1)])]),_:1}),l(a(S),{color:"secondary",onClick:e[3]||(e[3]=m=>I())},{default:t(()=>[...e[16]||(e[16]=[_("수정",-1)])]),_:1}),l(a(S),{color:"danger",onClick:e[4]||(e[4]=m=>D())},{default:t(()=>[...e[17]||(e[17]=[_("삭제",-1)])]),_:1})]),l(a(j),{class:"g-3 mb-3"},{default:t(()=>[l(a(Q),{md:"3"},{default:t(()=>[l(n,null,{default:t(()=>[l(d,{style:{"min-width":"95px"}},{default:t(()=>[...e[18]||(e[18]=[_("검사자",-1)])]),_:1}),l(a(V),{modelValue:o.value.emp_nm,"onUpdate:modelValue":e[5]||(e[5]=m=>o.value.emp_nm=m),placeholder:"검사자 이름"},null,8,["modelValue"])]),_:1})]),_:1}),l(a(Q),{md:"3"},{default:t(()=>[l(n,null,{default:t(()=>[l(d,{style:{"min-width":"95px"}},{default:t(()=>[...e[19]||(e[19]=[_("출고처",-1)])]),_:1}),l(a(V),{modelValue:o.value.co_nm,"onUpdate:modelValue":e[6]||(e[6]=m=>o.value.co_nm=m),readonly:"",class:"bg-light"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(a(j),{class:"g-3 mb-3"},{default:t(()=>[l(a(Q),{md:"3"},{default:t(()=>[l(n,null,{default:t(()=>[l(d,{style:{"min-width":"95px"}},{default:t(()=>[...e[20]||(e[20]=[_("자재명",-1)])]),_:1}),l(a(V),{modelValue:o.value.rcs_nm,"onUpdate:modelValue":e[7]||(e[7]=m=>o.value.rcs_nm=m),readonly:"",class:"bg-light",placeholder:"자재발주서조회",onClick:w},null,8,["modelValue"])]),_:1})]),_:1}),l(a(Q),{md:"3"},{default:t(()=>[l(n,null,{default:t(()=>[l(d,null,{default:t(()=>[...e[21]||(e[21]=[_("발주 수량",-1)])]),_:1}),l(a(V),{modelValue:o.value.qy,"onUpdate:modelValue":e[8]||(e[8]=m=>o.value.qy=m),modelModifiers:{number:!0},readonly:"",type:"number",min:"0",class:"bg-light"},null,8,["modelValue"])]),_:1})]),_:1}),l(a(Q),{md:"3"},{default:t(()=>[l(n,null,{default:t(()=>[l(d,null,{default:t(()=>[...e[22]||(e[22]=[_("기입고 수량",-1)])]),_:1}),l(a(V),{modelValue:o.value.receivedQty,"onUpdate:modelValue":e[9]||(e[9]=m=>o.value.receivedQty=m),modelModifiers:{number:!0},readonly:"",type:"number",min:"0",class:"bg-light"},null,8,["modelValue"])]),_:1})]),_:1}),l(a(Q),{md:"3"},{default:t(()=>[l(n,null,{default:t(()=>[l(d,null,{default:t(()=>[...e[23]||(e[23]=[_("미입고 수량",-1)])]),_:1}),l(a(V),{value:M.value,readonly:"",type:"number",class:"bg-light"},null,8,["value"])]),_:1})]),_:1})]),_:1}),l(a(j),{class:"g-3 mb-3"},{default:t(()=>[l(a(Q),{md:"3"},{default:t(()=>[l(n,null,{default:t(()=>[l(d,null,{default:t(()=>[...e[24]||(e[24]=[_("검수 수량",-1)])]),_:1}),l(a(V),{modelValue:o.value.insp_qy,"onUpdate:modelValue":e[10]||(e[10]=m=>o.value.insp_qy=m),modelModifiers:{number:!0},type:"number",min:"0"},null,8,["modelValue"])]),_:1})]),_:1}),l(a(Q),{md:"3"},{default:t(()=>[l(n,null,{default:t(()=>[l(d,null,{default:t(()=>[...e[25]||(e[25]=[_("합격 수량",-1)])]),_:1}),l(a(V),{value:i.value,readonly:"",type:"number",min:"0",class:"bg-light"},null,8,["value"])]),_:1})]),_:1}),l(a(Q),{md:"3"},{default:t(()=>[l(n,null,{default:t(()=>[l(d,{style:{"min-width":"110px"}},{default:t(()=>[...e[26]||(e[26]=[_(" 불량 수량 ",-1)])]),_:1}),l(a(V),{value:N.value,readonly:"",type:"number",class:"bg-light"},null,8,["value"])]),_:1})]),_:1}),l(a(Q),{md:"3"},{default:t(()=>[l(n,null,{default:t(()=>[l(d,{style:{"min-width":"110px"}},{default:t(()=>[...e[27]||(e[27]=[_("검사 일자",-1)])]),_:1}),l(a(V),{type:"date",modelValue:o.value.insp_dt,"onUpdate:modelValue":e[11]||(e[11]=m=>o.value.insp_dt=m)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(a(oe),{modelValue:o.value.note,"onUpdate:modelValue":e[12]||(e[12]=m=>o.value.note=m),label:"비고",rows:"3",text:"필요 시 기재"},null,8,["modelValue"]),e[33]||(e[33]=s("div",{class:"d-flex justify-content-end gap-2 mb-3"},null,-1)),l(a(ne),{hover:"",bordered:"",small:"",class:"align-middle mt-4"},{default:t(()=>[l(a(ae),{color:"dark"},{default:t(()=>[l(a(E),null,{default:t(()=>[l(a(L),{class:"text-center"},{default:t(()=>[...e[28]||(e[28]=[_("검사항목",-1)])]),_:1}),l(a(L),{class:"text-center"},{default:t(()=>[...e[29]||(e[29]=[_("기준치",-1)])]),_:1}),l(a(L),{class:"text-center"},{default:t(()=>[...e[30]||(e[30]=[_("오차범위",-1)])]),_:1}),l(a(L),{class:"text-center"},{default:t(()=>[...e[31]||(e[31]=[_("불량수량",-1)])]),_:1})]),_:1})]),_:1}),l(a(se),null,{default:t(()=>[(q(!0),$(K,null,W(p.value,(m,Y)=>(q(),H(a(E),{key:Y},{default:t(()=>[l(a(G),null,{default:t(()=>[_(C(m.insp_item_nm),1)]),_:2},1024),l(a(G),null,{default:t(()=>[_(C(m.basi_val),1)]),_:2},1024),l(a(G),null,{default:t(()=>[_(C(m.eror_scope_min+"~"+m.eror_scope_max),1)]),_:2},1024),l(a(G),{class:"text-start",style:{width:"120px"}},{default:t(()=>[l(a(V),{modelValue:m.infer_qy,"onUpdate:modelValue":Z=>m.infer_qy=Z,size:"sm",placeholder:"불량수량기입"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128)),p.value.length===0?(q(),H(a(E),{key:0},{default:t(()=>[l(a(G),{colspan:"4",class:"text-center text-muted py-4"},{default:t(()=>[...e[32]||(e[32]=[_("검사항목이 없습니다.",-1)])]),_:1})]),_:1})):J("",!0)]),_:1})]),_:1})]),_:1})}}},Qe=le(xe,[["__scopeId","data-v-20ba9fe6"]]);export{Qe as default};
