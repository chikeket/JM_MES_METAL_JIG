import{r as V,s as O,e as y,c as Q,a as C,w as t,d as l,g as r,f as a,j as H,H as J,v as E,b as S,F as L,h as W,u as n,t as b,m as P,_ as Y,i as Z,q as j,z as ee,L as $,X as w,U as x,W as z,$ as le,M as te,N as h,O as R,Q as oe,x as ne,K as N,R as ae}from"./index-TO8iFplr.js";import{u as K}from"./useDates-sS5pNIz9.js";const se={class:"modal-body",style:{"max-height":"400px","overflow-y":"auto"}},de={class:"d-flex gap-2 mb-3"},ue={class:"d-flex gap-2 mb-3"},re={class:"table table-bordered table-hover"},ie={class:"table table-bordered table-hover mb-0"},_e=["onDblclick"],pe={__name:"waitingFinishedPrdtModal",props:{visible:Boolean},emits:["close","select"],setup(G,{emit:I}){const g=I,q=()=>{v.value=[],g("close")},m=V({pickValue:"prdt_nm",wk_to_dt:"",searchKeyword:""});let v=O([]);const k=async()=>{v.value=[];const o={prdt_nm:"",pass_qy:"",wk_to_dt:m.value.wk_to_dt||"1970-01-01"};m.value.pickValue=="prdt_nm"?o.prdt_nm=m.value.searchKeyword:o.pass_qy=m.value.searchKeyword;let s=await P.get("/api/waitingFinishedPrdt",{params:o}).catch(u=>console.log(u));v.value=s.data,console.log(v.value),m.value.wk_to_dt="",m.value.searchKeyword=""},T=async o=>{const s={prdt_id:"",prdt_opt_id:""};s.prdt_id=o.prdt_id,s.prdt_opt_id=o.prdt_opt_id;let u=await P.get("/api/waitingPrdtQltyDeta",{params:s}).catch(f=>console.log(f));console.log(u.data),g("select",{detailData:u.data,searchParams:o}),q()};return(o,s)=>{const u=y("CModalTitle"),f=y("CModalHeader"),M=y("CInputGroupText"),F=y("CModalBody"),D=y("CButton"),U=y("CModalFooter"),B=y("CModal");return C(),Q(B,{visible:G.visible,onClose:q},{default:t(()=>[l(f,null,{default:t(()=>[l(u,null,{default:t(()=>[...s[4]||(s[4]=[r("완제품생산실적조회",-1)])]),_:1})]),_:1}),l(F,null,{default:t(()=>[a("div",se,[a("div",de,[H(a("select",{class:"form-select",style:{width:"150px"},"onUpdate:modelValue":s[0]||(s[0]=d=>m.value.pickValue=d)},[...s[5]||(s[5]=[a("option",{value:"prdt_nm"},"완제품명",-1),a("option",{value:"pass_qy"},"검사대기수량",-1)])],512),[[J,m.value.pickValue]]),H(a("input",{type:"text",class:"form-control",placeholder:"검색어 입력","onUpdate:modelValue":s[1]||(s[1]=d=>m.value.searchKeyword=d)},null,512),[[E,m.value.searchKeyword]])]),a("div",ue,[l(M,{id:"addon-ordr-name-2"},{default:t(()=>[...s[6]||(s[6]=[r("작업종료날짜",-1)])]),_:1}),H(a("input",{type:"date",class:"form-control","onUpdate:modelValue":s[2]||(s[2]=d=>m.value.wk_to_dt=d)},null,512),[[E,m.value.wk_to_dt]]),a("button",{class:"btn btn-secondary",style:{width:"100px"},onClick:s[3]||(s[3]=d=>k())},"검색")]),a("table",re,[s[7]||(s[7]=a("thead",{class:"table-light"},[a("tr",null,[a("th",null,"완제품명"),a("th",null,"옵션명"),a("th",null,"검사대기수량"),a("th",null,"작업종료날짜")])],-1)),a("tbody",ie,[(C(!0),S(L,null,W(n(v),(d,e)=>(C(),S("tr",{key:e,onDblclick:p=>T(d)},[a("td",null,b(d.prdt_nm),1),a("td",null,b(d.opt_nm),1),a("td",null,b(Number(d.bePass_qy)),1),a("td",null,b(n(K).dateFormat(d.wk_to_dt,"yyyy-MM-dd")),1)],40,_e))),128))])])])]),_:1}),l(U,null,{default:t(()=>[l(D,{color:"secondary",onClick:q},{default:t(()=>[...s[8]||(s[8]=[r("닫기",-1)])]),_:1})]),_:1})]),_:1},8,["visible"])}}},me={class:"modal-body",style:{"max-height":"400px","overflow-y":"auto"}},ye={class:"mb-3"},ve={class:"d-flex gap-2 mb-3"},ce={class:"d-flex gap-2 mb-3"},fe={class:"table table-bordered table-hover"},be={class:"table table-bordered table-hover mb-0"},Ce=["onDblclick"],ge={__name:"endPrdtQltyInspModal",props:{visible:Boolean},emits:["close","select"],setup(G,{emit:I}){const g=I,q=()=>{m.value="",v.value="",k.value=[],g("close")},m=V(""),v=V("");let k=O([]);const T=async()=>{const s={emp_nm:m.value||"",insp_dt:v.value||"1970-01-01"};console.log(s);let u=await P.get("/api/endPrdtQltyInspSearch",{params:s}).catch(f=>console.log(f));k.value=u.data},o=async s=>{const u={end_prdt_qlty_insp_id:""};u.end_prdt_qlty_insp_id=s.end_prdt_qlty_insp_id,console.log(s);let f=await P.get("/api/endPrdtQltyInspInferSearch",{params:u}).catch(M=>console.log(M));console.log(f.data),g("select",{detailData:f.data,searchParams:s}),q()};return(s,u)=>{const f=y("CModalTitle"),M=y("CModalHeader"),F=y("CInputGroupText"),D=y("CFormInput"),U=y("CInputGroup"),B=y("CModalBody"),d=y("CButton"),e=y("CModalFooter"),p=y("CModal");return C(),Q(p,{visible:G.visible,onClose:q,size:"xl"},{default:t(()=>[l(M,null,{default:t(()=>[l(f,null,{default:t(()=>[...u[3]||(u[3]=[r("완제품 품질조회",-1)])]),_:1})]),_:1}),l(B,null,{default:t(()=>[a("div",me,[a("div",ye,[a("div",ve,[l(U,{class:"mb-2"},{default:t(()=>[l(F,{id:"addon-ordr-name-1"},{default:t(()=>[...u[4]||(u[4]=[r("검사자",-1)])]),_:1}),l(D,{modelValue:m.value,"onUpdate:modelValue":u[0]||(u[0]=i=>m.value=i),placeholder:"검수자이름"},null,8,["modelValue"])]),_:1})]),a("div",ce,[l(F,{id:"addon-ordr-name-2"},{default:t(()=>[...u[5]||(u[5]=[r("검사 일자",-1)])]),_:1}),H(a("input",{type:"date",class:"form-control","onUpdate:modelValue":u[1]||(u[1]=i=>v.value=i)},null,512),[[E,v.value]]),a("button",{class:"btn btn-secondary",style:{width:"70px"},onClick:u[2]||(u[2]=i=>T())}," 검색 ")])]),a("table",fe,[u[6]||(u[6]=a("thead",{class:"table-light"},[a("tr",null,[a("th",null,"검사자"),a("th",null,"제품명"),a("th",null,"옵션명"),a("th",null,"검사 수량"),a("th",null,"검사 일자")])],-1)),a("tbody",be,[(C(!0),S(L,null,W(n(k),(i,c)=>(C(),S("tr",{key:c,onDblclick:_=>o(i)},[a("td",null,b(i.emp_nm),1),a("td",null,b(i.prdt_nm),1),a("td",null,b(i.opt_nm),1),a("td",null,b(Math.floor(i.insp_qy)),1),a("td",null,b(n(K).dateFormat(i.reg_dt,"yyyy-MM-dd")),1)],40,Ce))),128))])])])]),_:1}),l(e,null,{default:t(()=>[l(d,{color:"secondary",onClick:q},{default:t(()=>[...u[7]||(u[7]=[r("닫기",-1)])]),_:1})]),_:1})]),_:1},8,["visible"])}}},qe={class:"d-flex justify-content-end gap-2 mb-3"},xe={class:"d-flex justify-content-end gap-2 mb-3"},Me={__name:"endPrdtQltyInsp",setup(G){const I=Z(),g=V(!1),q=()=>{g.value=!0},m=()=>{g.value=!1},v=V(!1),k=()=>{v.value=!0},T=()=>{v.value=!1},o=V({emp_id:I.user?.emp_id||"EMP001",emp_nm:I.user?.emp_nm||"홍길동",prdt_nm:"",opt_nm:"",qy:"",insp_qy:"",insp_dt:K.dateFormat(new Date,"yyyy-MM-dd"),rm:"",prcs_ctrl_id:"",end_prdt_qlty_insp_id:""}),s=V([]),u=V(0);j(s,d=>{let e=0;for(const p of d){const i=Number(p.infer_qy);isNaN(i)||(e+=i)}u.value=e},{deep:!0});const f=ee(()=>{const d=Number(o.value.insp_qy)||0,e=Number(u.value)||0;return d-e});j(()=>o.value.insp_qy,d=>{const e=Number(o.value.qy)||0,p=Number(d);if(isNaN(p)||p<0){alert("검수 수량은 0 이상의 숫자만 입력 가능합니다."),o.value.pass_qy=0;return}p>e&&(alert("검수 수량이 실적 수량보다 많을 수 없습니다."),o.value.pass_qy=0)});const M=d=>{s.value=[],o.value.prdt_nm=d.searchParams.prdt_nm,o.value.opt_nm=d.searchParams.opt_nm,o.value.qy=Math.floor(d.searchParams.bePass_qy),o.value.insp_qy=Math.floor(d.searchParams.insp_qy)||0,o.value.pass_qy=Math.floor(d.searchParams.pass_qy)||0,o.value.rm=d.searchParams.rm?d.searchParams.rm:"",o.value.prcs_ctrl_id=d.searchParams.prcs_ctrl_id,o.value.end_prdt_qlty_insp_id=d.searchParams.end_prdt_qlty_insp_id;for(const e of d.detailData)s.value.push({insp_item_nm:e.insp_item_nm,basi_val:e.basi_val,eror_scope_min:e.eror_scope_min,eror_scope_max:e.eror_scope_max,infer_qy:e.infer_qy||0,qlty_item_mng_id:e.qlty_item_mng_id,end_prdt_qlty_insp_id:e.end_prdt_qlty_insp_id});console.log(o.value)},F=async()=>{let d=[];for(const c of s.value)d.push({infer_qy:c.infer_qy,qlty_item_mng_id:c.qlty_item_mng_id});const e={master:{rm:o.value.rm,prcs_ctrl_id:o.value.prcs_ctrl_id,emp_id:o.value.emp_id,infer_qy:u.value,pass_qy:f.value,insp_qy:o.value.insp_qy,insp_dt:o.value.insp_dt},infer:d};console.log(e),(await P.post("/api/endPrdtQltyInspInsert",e).catch(c=>console.log(c))).data.isSuccessed?console.log("완제품 검수가 등록되었습니다."):console.log("완제품 검수에 실패했습니다.")},D=async()=>{let d=[];for(const c of s.value)d.push({infer_qy:c.infer_qy,qlty_item_mng_id:c.qlty_item_mng_id,end_prdt_qlty_insp_id:c.end_prdt_qlty_insp_id});const e={master:{rm:o.value.rm,prcs_ctrl_id:o.value.prcs_ctrl_id,emp_id:o.value.emp_id,infer_qy:u.value,pass_qy:o.value.pass_qy,insp_qy:o.value.insp_qy,insp_dt:o.value.insp_dt,end_prdt_qlty_insp_id:o.value.end_prdt_qlty_insp_id},infer:d};(await P.post("/api/endPrdtQltyInspUpdate",e).catch(c=>console.log(c))).data.isSuccessed?console.log("완제품 검수 수정이 등록되었습니다."):console.log("완제품 검수 수정에 실패했습니다.")},U=async()=>{const d={end_prdt_qlty_insp_id:o.value.end_prdt_qlty_insp_id};(await P.post("/api/endPrdtQltyInspDelete",d).catch(i=>console.log(i))).data.isSuccessed?console.log("완제품 검수 삭제가 성공되었습니다."):console.log("완제품 검수 삭제가 실패했습니다.")},B=async()=>{o.value.prdt_nm="",o.value.opt_nm="",o.value.qy=0,o.value.insp_qy=0,o.value.insp_dt=K.dateFormat(new Date,"yyyy-MM-dd"),o.value.rm="",o.value.prcs_ctrl_id="",o.value.end_prdt_qlty_insp_id="",s.value=[]};return(d,e)=>{const p=y("CInputGroupText"),i=y("CInputGroup"),c=y("CContainer");return C(),Q(c,{fluid:""},{default:t(()=>[a("div",qe,[e[18]||(e[18]=r(" 완제품 품질검사 관리 ",-1)),l(n($),{color:"secondary",onClick:e[0]||(e[0]=_=>B())},{default:t(()=>[...e[13]||(e[13]=[r("신규",-1)])]),_:1}),l(n($),{color:"secondary",onClick:e[1]||(e[1]=_=>q())},{default:t(()=>[...e[14]||(e[14]=[r("생산실적조회",-1)])]),_:1}),l(pe,{visible:g.value,onClose:m,onSelect:M},null,8,["visible"]),l(n($),{color:"secondary",onClick:e[2]||(e[2]=_=>F())},{default:t(()=>[...e[15]||(e[15]=[r("저장",-1)])]),_:1}),l(n($),{color:"secondary",onClick:e[3]||(e[3]=_=>D())},{default:t(()=>[...e[16]||(e[16]=[r("수정",-1)])]),_:1}),l(n($),{color:"danger",onClick:e[4]||(e[4]=_=>U())},{default:t(()=>[...e[17]||(e[17]=[r("삭제",-1)])]),_:1})]),l(n(z),{class:"g-3 mb-3"},{default:t(()=>[l(n(w),{md:"3"},{default:t(()=>[l(i,null,{default:t(()=>[l(p,{style:{"min-width":"95px"}},{default:t(()=>[...e[19]||(e[19]=[r("검사자",-1)])]),_:1}),l(n(x),{modelValue:o.value.emp_nm,"onUpdate:modelValue":e[5]||(e[5]=_=>o.value.emp_nm=_),placeholder:"검사자 이름"},null,8,["modelValue"])]),_:1})]),_:1}),l(n(w),{md:"3"},{default:t(()=>[l(i,null,{default:t(()=>[l(p,{style:{"min-width":"95px"}},{default:t(()=>[...e[20]||(e[20]=[r("완제품명",-1)])]),_:1}),l(n(x),{modelValue:o.value.prdt_nm,"onUpdate:modelValue":e[6]||(e[6]=_=>o.value.prdt_nm=_),readonly:"",class:"bg-light"},null,8,["modelValue"])]),_:1})]),_:1}),l(n(w),{md:"3"},{default:t(()=>[l(i,null,{default:t(()=>[l(p,{style:{"min-width":"95px"}},{default:t(()=>[...e[21]||(e[21]=[r("옵션명",-1)])]),_:1}),l(n(x),{modelValue:o.value.opt_nm,"onUpdate:modelValue":e[7]||(e[7]=_=>o.value.opt_nm=_),readonly:"",class:"bg-light"},null,8,["modelValue"])]),_:1})]),_:1}),l(n(w),{md:"3"},{default:t(()=>[l(i,null,{default:t(()=>[l(p,null,{default:t(()=>[...e[22]||(e[22]=[r("실적 수량",-1)])]),_:1}),l(n(x),{modelValue:o.value.qy,"onUpdate:modelValue":e[8]||(e[8]=_=>o.value.qy=_),modelModifiers:{number:!0},readonly:"",type:"number",min:"0",class:"bg-light"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(n(z),{class:"g-3 mb-3"},{default:t(()=>[l(n(w),{md:"3"},{default:t(()=>[l(i,null,{default:t(()=>[l(p,null,{default:t(()=>[...e[23]||(e[23]=[r("검수 수량",-1)])]),_:1}),l(n(x),{modelValue:o.value.insp_qy,"onUpdate:modelValue":e[9]||(e[9]=_=>o.value.insp_qy=_),modelModifiers:{number:!0},type:"number",min:"0"},null,8,["modelValue"])]),_:1})]),_:1}),l(n(w),{md:"3"},{default:t(()=>[l(i,null,{default:t(()=>[l(p,null,{default:t(()=>[...e[24]||(e[24]=[r("합격 수량",-1)])]),_:1}),l(n(x),{value:f.value,readonly:"",type:"number",min:"0",class:"bg-light"},null,8,["value"])]),_:1})]),_:1}),l(n(w),{md:"3"},{default:t(()=>[l(i,null,{default:t(()=>[l(p,{style:{"min-width":"110px"}},{default:t(()=>[...e[25]||(e[25]=[r(" 불량 수량 ",-1)])]),_:1}),l(n(x),{value:u.value,readonly:"",type:"number",class:"bg-light"},null,8,["value"])]),_:1})]),_:1}),l(n(w),{md:"3"},{default:t(()=>[l(i,null,{default:t(()=>[l(p,{style:{"min-width":"110px"}},{default:t(()=>[...e[26]||(e[26]=[r("검사 일자",-1)])]),_:1}),l(n(x),{type:"date",modelValue:o.value.insp_dt,"onUpdate:modelValue":e[10]||(e[10]=_=>o.value.insp_dt=_)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(n(le),{modelValue:o.value.rm,"onUpdate:modelValue":e[11]||(e[11]=_=>o.value.rm=_),label:"비고",rows:"3",text:"필요 시 기재"},null,8,["modelValue"]),a("div",xe,[l(n($),{color:"secondary",onClick:e[12]||(e[12]=_=>k())},{default:t(()=>[...e[27]||(e[27]=[r("완제품 품질조회",-1)])]),_:1}),l(ge,{visible:v.value,onClose:T,onSelect:M},null,8,["visible"])]),l(n(ae),{hover:"",bordered:"",small:"",class:"align-middle mt-4"},{default:t(()=>[l(n(te),{color:"dark"},{default:t(()=>[l(n(h),null,{default:t(()=>[l(n(R),{class:"text-center"},{default:t(()=>[...e[28]||(e[28]=[r("검사항목",-1)])]),_:1}),l(n(R),{class:"text-center"},{default:t(()=>[...e[29]||(e[29]=[r("기준치",-1)])]),_:1}),l(n(R),{class:"text-center"},{default:t(()=>[...e[30]||(e[30]=[r("오차범위",-1)])]),_:1}),l(n(R),{class:"text-center"},{default:t(()=>[...e[31]||(e[31]=[r("불량수량",-1)])]),_:1})]),_:1})]),_:1}),l(n(oe),null,{default:t(()=>[(C(!0),S(L,null,W(s.value,(_,A)=>(C(),Q(n(h),{key:A},{default:t(()=>[l(n(N),null,{default:t(()=>[r(b(_.insp_item_nm),1)]),_:2},1024),l(n(N),null,{default:t(()=>[r(b(_.basi_val),1)]),_:2},1024),l(n(N),null,{default:t(()=>[r(b(_.eror_scope_min+"~"+_.eror_scope_max),1)]),_:2},1024),l(n(N),{class:"text-start",style:{width:"120px"}},{default:t(()=>[l(n(x),{modelValue:_.infer_qy,"onUpdate:modelValue":X=>_.infer_qy=X,size:"sm",placeholder:"불량수량기입"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128)),s.value.length===0?(C(),Q(n(h),{key:0},{default:t(()=>[l(n(N),{colspan:"4",class:"text-center text-muted py-4"},{default:t(()=>[...e[32]||(e[32]=[r("검사항목이 없습니다.",-1)])]),_:1})]),_:1})):ne("",!0)]),_:1})]),_:1})]),_:1})}}},ke=Y(Me,[["__scopeId","data-v-b19b4374"]]);export{ke as default};
