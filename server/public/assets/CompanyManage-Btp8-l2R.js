import{_ as ue,y as L,r as g,z as j,o as ie,D as ce,c as k,w as l,f as n,d as s,g as d,e as r,b,x as M,t as v,h as T,F as N,m as S,a as u,p as me}from"./index-TO8iFplr.js";const pe={class:"d-flex justify-content-end mb-3 gap-2"},fe={class:"search-filter-box mb-3"},ye={class:"custom-select-wrapper"},ve={key:0,class:"custom-dropdown"},ge={class:"custom-select-wrapper"},be={key:0,class:"custom-dropdown"},Ce={class:"d-flex gap-2 mb-2",style:{"min-height":"50px","align-items":"center",padding:"0.8rem 0"}},_e={class:"grid-box flex-grow-1 overflow-hidden d-flex flex-column"},we={class:"table-wrapper"},ke={class:"d-flex gap-2 justify-content-end mb-2",style:{"min-height":"50px","align-items":"center",padding:"0.8rem 0"}},xe={class:"form-box flex-grow-1 d-flex flex-column overflow-hidden"},he={class:"p-3 flex-grow-1 overflow-hidden"},De={class:"radio-group-horizontal"},Te={__name:"CompanyManage",setup(Ne){const i=L({type:"",name:"",status:""}),C=g(!1),_=g(!1),I=g(null),z=g(null),o=L({id:"",businessNo:"",name:"",ceo:"",email:"",ceoPhone:"",regDate:"",managerName:"",managerPhone:"",type:"customer",status:"active"}),H=[{key:"id",label:"업체 ID",type:"text"},{key:"businessNo",label:"사업자 등록번호",type:"text"},{key:"name",label:"업체명",type:"text"},{key:"ceo",label:"대표자명",type:"text"},{key:"email",label:"대표 이메일",type:"text"},{key:"ceoPhone",label:"대표 연락처",type:"text"},{key:"regDate",label:"등록일자",type:"date"},{key:"managerName",label:"담당자명",type:"text"},{key:"managerPhone",label:"담당자 연락처",type:"text"}],q=[{key:"type",label:"업체유형",type:"radio",options:[{label:"고객사",value:"customer"},{label:"공급업체",value:"supplier"}]},{key:"status",label:"상태",type:"radio",options:[{label:"활성",value:"active"},{label:"비활성",value:"inactive"}]}],p=g([]),x=g(null),V=g(""),P=j(()=>p.value.slice(0,10)),G=j(()=>{const t=P.value.length;return t<10?10-t:0});ie(()=>{document.addEventListener("click",$)}),ce(()=>{document.removeEventListener("click",$)});const J=()=>{C.value=!C.value,_.value=!1},K=()=>{_.value=!_.value,C.value=!1},R=t=>{i.type=t,C.value=!1},F=t=>{i.status=t,_.value=!1},Q=t=>t==="VENDOR"?"공급업체":t==="CUSTOMER"?"고객사":"전체",W=t=>t==="ACT"?"활성":t==="INA"?"비활성":"전체",$=t=>{I.value&&!I.value.contains(t.target)&&(C.value=!1),z.value&&!z.value.contains(t.target)&&(_.value=!1)},O=async()=>{const t={type:i.type||"",name:i.name||"",status:i.status||""};try{let e=await S.get("/api/co_list_view",{params:t});p.value=(e.data||[]).sort((f,y)=>{const c=parseInt(f.id.replace(/\D/g,""))||0,h=parseInt(y.id.replace(/\D/g,""))||0;return c-h}),x.value=null}catch(e){console.error("조회 오류:",e),p.value=[]}},X=()=>{i.type="",i.name="",i.status="",x.value=null,p.value=[]},U=()=>{Object.assign(o,{id:"",businessNo:"",name:"",ceo:"",email:"",ceoPhone:"",regDate:"",managerName:"",managerPhone:"",type:"customer",status:"active"}),V.value="",x.value=null},Y=()=>{if(console.log("현재 그리드 데이터:",p.value),console.log("그리드 데이터 개수:",p.value.length),p.value.length>0){const t=p.value[p.value.length-1].id;console.log("마지막 ID:",t);const e=t.match(/^CO(\d+)$/);if(e){const y=parseInt(e[1])+1,c=`CO${String(y).padStart(3,"0")}`;return console.log("생성된 새 ID:",c),c}}return console.log("데이터 없음, CO001 반환"),"CO001"},Z=(t,e)=>{o.id=t.id,o.businessNo=t.businessNo,o.name=t.name,o.ceo=t.ceo,o.ceoPhone=t.ceoPhone,o.type=t.type==="CUSTOMER"?"customer":"supplier",o.status=t.status==="ACT"?"active":"inactive",V.value=t.id,x.value=e},ee=()=>{U(),o.id=Y()},te=async()=>{if(!o.name||!o.ceo){alert("업체명과 대표자명은 필수 입력 항목입니다.");return}try{const t={co_id:o.id,bizr_reg_no:o.businessNo,co_nm:o.name,rpstr_nm:o.ceo,rpstr_tel:o.ceoPhone,co_ty_id:o.type==="customer"?"CUSTOMER":"VENDOR",st:o.status==="active"?"ACT":"INA"};let e;V.value?(t.co_id=o.id,t.original_co_id=V.value,e=await S.post("/api/coUpdate",t)):e=await S.post("/api/coInsert",t),e.data.isSuccessed?(alert(e.data.message),await O(),U()):alert(e.data.message)}catch(t){console.error("저장 오류:",t),alert("저장 중 오류가 발생했습니다.")}},le=async()=>{if(!o.id){alert("삭제할 데이터를 선택해주세요.");return}if(confirm("정말 삭제하시겠습니까?"))try{const t=await S.post("/api/coDelete",{co_id:o.id});t.data.isSuccessed&&(alert(t.data.message),await O(),U())}catch(t){console.error("삭제 오류:",t),alert("삭제 중 오류가 발생했습니다.")}},se=t=>t==="CUSTOMER"?"고객사":"공급업체";return(t,e)=>{const f=r("CButton"),y=r("CFormLabel"),c=r("CCol"),h=r("CFormInput"),B=r("CRow"),D=r("CTableHeaderCell"),E=r("CTableRow"),ae=r("CTableHead"),w=r("CTableDataCell"),oe=r("CTableBody"),ne=r("CTable"),de=r("CFormCheck"),re=r("CContainer");return u(),k(re,{fluid:"",class:"h-100 d-flex flex-column p-3"},{default:l(()=>[n("div",pe,[s(f,{color:"secondary",size:"sm",onClick:O,class:"btn-search"},{default:l(()=>[...e[7]||(e[7]=[d("조회",-1)])]),_:1}),s(f,{color:"secondary",size:"sm",onClick:X,class:"btn-reset"},{default:l(()=>[...e[8]||(e[8]=[d("초기화",-1)])]),_:1})]),n("div",fe,[s(B,{class:"g-3"},{default:l(()=>[s(c,{md:3},{default:l(()=>[s(y,{class:"form-label"},{default:l(()=>[...e[9]||(e[9]=[d("업체유형",-1)])]),_:1}),n("div",ye,[n("div",{class:"custom-select",onClick:J,ref_key:"typeSelect",ref:I},[n("span",null,v(Q(i.type)),1),e[10]||(e[10]=n("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 12 12"},[n("path",{fill:"#495057",d:"M6 9L1 4h10z"})],-1))],512),C.value?(u(),b("div",ve,[n("div",{class:"custom-option",onClick:e[0]||(e[0]=a=>R(""))},"전체"),n("div",{class:"custom-option",onClick:e[1]||(e[1]=a=>R("VENDOR"))},"공급업체"),n("div",{class:"custom-option",onClick:e[2]||(e[2]=a=>R("CUSTOMER"))},"고객사")])):M("",!0)])]),_:1}),s(c,{md:4},{default:l(()=>[s(y,{class:"form-label"},{default:l(()=>[...e[11]||(e[11]=[d("업체명",-1)])]),_:1}),s(h,{modelValue:i.name,"onUpdate:modelValue":e[3]||(e[3]=a=>i.name=a),size:"sm",class:"form-input-enhanced"},null,8,["modelValue"])]),_:1}),s(c,{md:3},{default:l(()=>[s(y,{class:"form-label"},{default:l(()=>[...e[12]||(e[12]=[d("상태",-1)])]),_:1}),n("div",ge,[n("div",{class:"custom-select",onClick:K,ref_key:"statusSelect",ref:z},[n("span",null,v(W(i.status)),1),e[13]||(e[13]=n("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 12 12"},[n("path",{fill:"#495057",d:"M6 9L1 4h10z"})],-1))],512),_.value?(u(),b("div",be,[n("div",{class:"custom-option",onClick:e[4]||(e[4]=a=>F(""))},"전체"),n("div",{class:"custom-option",onClick:e[5]||(e[5]=a=>F("ACT"))},"활성"),n("div",{class:"custom-option",onClick:e[6]||(e[6]=a=>F("INA"))},"비활성")])):M("",!0)])]),_:1})]),_:1})]),s(B,{class:"flex-grow-1 overflow-hidden g-2"},{default:l(()=>[s(c,{md:7,class:"d-flex flex-column overflow-hidden pe-1"},{default:l(()=>[n("div",Ce,[s(f,{color:"secondary",size:"sm",class:"btn-hidden",style:{visibility:"hidden"}},{default:l(()=>[...e[14]||(e[14]=[d("숨김",-1)])]),_:1})]),n("div",_e,[n("div",we,[s(ne,{bordered:"",hover:"",class:"data-table"},{default:l(()=>[s(ae,null,{default:l(()=>[s(E,null,{default:l(()=>[s(D,{style:{width:"12%"}},{default:l(()=>[...e[15]||(e[15]=[d("업체 ID",-1)])]),_:1}),s(D,{style:{width:"15%"}},{default:l(()=>[...e[16]||(e[16]=[d("업체유형",-1)])]),_:1}),s(D,{style:{width:"35%"}},{default:l(()=>[...e[17]||(e[17]=[d("업체명",-1)])]),_:1}),s(D,{style:{width:"18%"}},{default:l(()=>[...e[18]||(e[18]=[d("대표자명",-1)])]),_:1}),s(D,{style:{width:"20%"}},{default:l(()=>[...e[19]||(e[19]=[d("담당자명",-1)])]),_:1})]),_:1})]),_:1}),s(oe,null,{default:l(()=>[(u(!0),b(N,null,T(P.value,(a,m)=>(u(),k(E,{key:m,onClick:A=>Z(a,m),class:me([{"selected-row":x.value===m},"data-row"])},{default:l(()=>[s(w,{class:"text-center"},{default:l(()=>[d(v(a.id),1)]),_:2},1024),s(w,null,{default:l(()=>[d(v(se(a.type)),1)]),_:2},1024),s(w,null,{default:l(()=>[d(v(a.name),1)]),_:2},1024),s(w,null,{default:l(()=>[d(v(a.ceo),1)]),_:2},1024),s(w,null,{default:l(()=>[d(v(a.managerName),1)]),_:2},1024)]),_:2},1032,["onClick","class"]))),128)),(u(!0),b(N,null,T(G.value,a=>(u(),k(E,{key:"empty-"+a,class:"empty-row"},{default:l(()=>[s(w,{colspan:"5"},{default:l(()=>[...e[20]||(e[20]=[d(" ",-1)])]),_:1})]),_:1}))),128))]),_:1})]),_:1})])])]),_:1}),s(c,{md:5,class:"d-flex flex-column overflow-hidden ps-1"},{default:l(()=>[n("div",ke,[s(f,{color:"secondary",size:"sm",onClick:ee,class:"btn-action"},{default:l(()=>[...e[21]||(e[21]=[d("신규",-1)])]),_:1}),s(f,{color:"secondary",size:"sm",onClick:te,class:"btn-action"},{default:l(()=>[...e[22]||(e[22]=[d("저장",-1)])]),_:1}),s(f,{color:"danger",size:"sm",onClick:le,class:"btn-action"},{default:l(()=>[...e[23]||(e[23]=[d("삭제",-1)])]),_:1})]),n("div",xe,[n("div",he,[s(B,{class:"g-3"},{default:l(()=>[s(c,{md:7},{default:l(()=>[(u(),b(N,null,T(H,a=>n("div",{key:a.key,class:"form-row-horizontal mb-2-5"},[s(y,{class:"form-label-inline"},{default:l(()=>[d(v(a.label),1)]),_:2},1024),a.type==="text"?(u(),k(h,{key:0,modelValue:o[a.key],"onUpdate:modelValue":m=>o[a.key]=m,size:"sm",disabled:a.key==="id",class:"form-input-enhanced"},null,8,["modelValue","onUpdate:modelValue","disabled"])):a.type==="date"?(u(),k(h,{key:1,modelValue:o[a.key],"onUpdate:modelValue":m=>o[a.key]=m,type:"date",size:"sm",class:"form-input-enhanced"},null,8,["modelValue","onUpdate:modelValue"])):M("",!0)])),64))]),_:1}),s(c,{md:5,class:"d-flex flex-column justify-content-start",style:{"padding-left":"56px"}},{default:l(()=>[(u(),b(N,null,T(q,a=>n("div",{key:a.key,class:"mb-4"},[s(y,{class:"form-label-radio"},{default:l(()=>[d(v(a.label),1)]),_:2},1024),n("div",De,[(u(!0),b(N,null,T(a.options,m=>(u(),k(de,{key:m.value,type:"radio",name:a.key,label:m.label,value:m.value,modelValue:o[a.key],"onUpdate:modelValue":A=>o[a.key]=A,class:"radio-item-inline"},null,8,["name","label","value","modelValue","onUpdate:modelValue"]))),128))])])),64))]),_:1})]),_:1})])])]),_:1})]),_:1})]),_:1})}}},Se=ue(Te,[["__scopeId","data-v-c2bded33"]]);export{Se as default};
